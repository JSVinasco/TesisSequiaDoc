#+TITLE: Modelamiento de Sequías en el Departamento de la Guajira por medio de técnicas impulsadas por datos
#+LaTeX_CLASS: report
#+LaTeX_CLASS_OPTIONS: [12pt,a4paper]
#+LANGUAGE:  es
#+OPTIONS:   H:4 num:t toc:nil title:nil \n:nil @:t ::t |:t ^:t -:t f:t *:t <:t
#+OPTIONS:   TeX:t LaTeX:t skip:nil d:nil todo:nil pri:nil tags:not-in-toc
#+LATEX_HEADER: \usepackage[spanish]{babel}
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: \usepackage{subfigure}
#+LATEX_HEADER: \usepackage{graphicx}
#+LATEX_HEADER: \usepackage{amsfonts,bm}
#+LATEX_HEADER: \usepackage{amsmath}
#+LATEX_HEADER: \usepackage{amssymb}
#+LATEX_HEADER: \usepackage{ifsym}
#+LATEX_HEADER: \usepackage{marvosym}
#+LATEX_HEADER: \usepackage{url}
#+LATEX_HEADER: \usepackage{fourier}
#+latex_header: \usepackage[T1]{fontenc}
#+LATEX_HEADER: \usepackage{geometry}
#+LATEX_HEADER: \geometry{left=2.5cm,right=2.5cm,top=2.5cm,bottom=4cm}
#+LATEX_HEADER: \linespread{1.2}
#+EXPORT_EXCLUDE_TAGS: noexport
#+latex_header: \usepackage{longtable}
#+latex_header: \usepackage{epsfig}
#+latex_header: \usepackage{epic}
#+latex_header: \usepackage{eepic}
#+latex_header: \usepackage{soul}
#+latex_header: \usepackage{enumitem}
#+latex_header: \usepackage{booktabs}
#+latex_header: \usepackage{multirow}
#+latex_header: \usepackage[normalem]{ulem}
#+latex_header: \usepackage{hyperref}
#+LATEX_HEADER: \hypersetup{colorlinks=true, linkcolor=black, citecolor=black, anchorcolor = black, citecolor = black, filecolor = black, urlcolor = black}
#+latex_header: \usepackage{titlesec, blindtext, color}
#+latex_header: \newcommand{\hsp}{\hspace{20pt}}
#+latex_header: \titleformat{\chapter}[hang]{\Huge\bfseries}{\thechapter\hsp\textcolor{gray75}{|}\hsp}{0pt}{\Huge\bfseries}
#+latex_header: \usepackage{fancyhdr}
#+latex_header: \pagestyle{fancy}
#+LATEX_HEADER: \usepackage{subcaption}
#+LATEX_HEADER: \captionsetup[table]{skip=8pt}
# +PROPERTY: header-args : exports none :tangle "~/Dropbox/Anteproyecto/bibliography/sequia.bib"

# +PROPERTY: header-args : exports none :tangle "~/Dropbox/bibliography/biblioteca.bib"


# +LATEX_HEADER: \usepackage{biblatex} \DeclareFieldFormat{apacase}{#1} \addbibresource{~/Dropbox/Anteproyecto/bibliography/sequia.bib}

# biblatex
# +LATEX_HEADER: \addbibresource{~/Dropbox/Anteproyecto/bibliography/sequia.bib}
# +LATEX_HEADER: \addbibresource{~/Dropbox/Anteproyecto/bibliography/sequia.bib}

# +LATEX_HEADER: \usepackage{parskip}
# +LATEX_HEADER: \bibliographystyle{ieeetran}
# +LATEX_HEADER: \usepackage[natbib=true,backend=biber]{biblatex}
# +LATEX_HEADER: \addbibresource{~/Dropbox/bibliography/biblioteca.bib}



#+LATEX_HEADER: \usepackage{parskip}
#+LATEX_HEADER: \bibliographystyle{ieeetran}
#+LATEX_HEADER: \usepackage[natbib=true,backend=biber]{biblatex}
#+LATEX_HEADER: \addbibresource{~/Dropbox/Anteproyecto/bibliography/sequia.bib}
# +PROPERTY: header-args : exports none :tangle "/home/juan//Dropbox/Anteproyecto/bibliography/sequia.bib"
#+KEYWORDS:   Sequı́a, Aprendizaje de Maquina, Modelos Espacio Temporales



#+BEGIN_EXPORT latex
  \begin{titlepage}
  \newpage
  %\setcounter{page}{1}
  \begin{center}
  \begin{figure}
  \centering%
  \epsfig{file=HojaTitulo/logo_univalle.eps,scale=0.12}%
  \end{figure}
  \thispagestyle{empty} \vspace*{0.1cm} \textbf{\huge
  Modelamiento de Sequ\'\i{}a en el departamento de La Guajira, Colombia}\\[5.5cm]
  \Large\textbf{Juan Sebasti\'an Vinasco Salinas}\\[5.5cm]
  \small Universidad del Valle\\
  Facultad de Ingenier\'\i{}a, Escuela Ingenier\'\i{}a Civil y Geom\'atica\\
  Santiago de Cali, Colombia\\
  2022\\
  \end{center}

  \newpage{\pagestyle{empty}\cleardoublepage}

  \newpage
  \begin{center}
  \thispagestyle{empty} \vspace*{0cm} \textbf{\huge
  Modelamiento de Sequ\'\i{}a en el departamento de la Guajira, Colombia}\\[2.0cm]
  \Large\textbf{Juan Sebasti\'an Vinasco Salinas}\\[2.0cm]
  \small Trabajo de grado presentado como requisito para optar al
  t\'{\i}tulo de:\\
  \textbf{Ingeniero Topogr\'afico}\\[2.0cm]
  Director:\\
  MSc. Francisco Luis Hernandez Torres \\[2.0cm]
  L\'{\i}nea de Investigaci\'{o}n:\\
  Modelamiento y monitoreo de fen\'omenos biof\'\i{}sicos \\
  Grupo de Investigaci\'{o}n en Percepci\'on Remota\\[2.0cm]
  Universidad del Valle\\
  Facultad de Ingenier\'\i{}a, Escuela Ingenier\'\i{}a Civil y Geom\'atica\\
  Santiago de Cali, Colombia\\
  2022\\
  \end{center}

  \newpage{\pagestyle{empty}\cleardoublepage}

  \newpage
  \thispagestyle{empty} \textbf{}\normalsize
  \\\\\\%
  \textbf{Alea iacta est}\\[4.0cm]



  \begin{flushright}
  \begin{minipage}{8cm}
      \noindent
          \small
          If you did not understand the nature of the beasts,\\
          \\[1.0cm]
          it would be of little use to know the mechanics of their anatomy. \\
  \end{minipage}
  \end{flushright}


  \newpage{\pagestyle{empty}\cleardoublepage}
\end{titlepage}






#+END_EXPORT

#  \newpage

* Agradecimientos
  :PROPERTIES:
  :UNNUMBERED: notoc
  :END:

  Para poder llegar a los resultados aquí descritos, he seguido un
  proceso arduo y complejo y en cada pequeño paso hubo personas que me extendieron su mano para ayudarme, así que a continuación enumeraré algunas de esas personas. \\

  Mi familia, sin cuyo apoyo a mi poco común y quizás algo irreflexiva
  empresa de lanzarme a hacer un trabajo de grado como el presente.\\

  A mis compañeros algunos que ejercieron como mentores Frank, Rafael,
  Mauricio y Wilmer. Otros que me inspiraron a continuar a través del
  ejemplo de sus proyectos, July, Sergio, Camilo, Daniel, Evelin, Laura,
  Stephany, Jorge, Diego, Valentina, Angie y otros que se me escapan.\\

  A mis profesores, que me enseñaron no solo conocimiento práctico sino también humano.\\

  Al profesor Francisco que me enseño el valor de soñar y perseguir los sueños.\\

  A la profesora Jackeline que me empujo para que pudiese llegar al presente resultado.\\

  Al profesor Mauricio con quien empecé esta aventura llamada investigación.\\

  A otros como Eduado Caicedo, Wilfredo Morales que compartieron su conocimiento en modelos impulsados por datos, al profesor John Sanabria que me abrio las puertas para a través de la tecnología extender los limites de los análisis que hacemos en la profesión, al menos en Univalle.\\

  A todos los anteriores, gracias totales !!! \\


#+LATEX:  \newpage

* Abreviaturas
  :PROPERTIES:
  :UNNUMBERED: notoc
  :END:

 NDVI : Índice Normalizado de Vegetación.\\

 NDWI : Índice de Agua Normalizado.\\

 EVI : Índice de Vegetación Mejorado. \\

 LST : Temperatura Superficial. \\

SPI: Índice de Sequía Estandarizado.\\

 SPI No Paramétrico: Índice de Sequía Estandarizado No Paramétrico.\\

 RF : /Random Forest/ o Bosque Aleatorio.\\

 XG : /XGBoost/ o /Xtrem Gradient Boosting/ o Aumento Extremo del Gradiente.\\

 NN : /Neural Networks/ o Redes Neuronales Artificiales\\.

 CART : /Classification And Regression Trees/ o Arboles de Clasificación y Regresión. \\

 MOD11A2 : Producto MODIS Temperatura Superficial \\

 MOD16A2 : Producto MODIS Evapotranspiración \\

 MCD43B3 : \\
 MCD15A2 : \\
 MYD13A2 : Producto MODIS índices de vegetación \\

#+LATEX:  \newpage
* Resumen
  :PROPERTIES:
  :UNNUMBERED: notoc
  :END:

  Las sequías son procesos hidrometeoro-lógicos que eliminan o disminuyen la cantidad y distribución espacial de la precipitación limitando la disponibilidad de agua superficial y/o subterránea, de modo que se presentan condiciones mucho mas secas de lo usual siendo estas potencialmente perjudiciales. En palabras de la Organización Meteorológica Mundial en su Manual de Indicadores de Sequía este fenómeno natural es uno de los que mas daños económicos causan año tras año, afectando de manera significativa a los bines y la calidad de vida de las personas. En particular en Colombia una de las zonas mas vulnerables a este fenómeno es el departamento de La Guajira, departamento que por sus condiciones geográficas, y sociales ha sido históricamente impactado por este fenómeno.\\

  Ahora bien, con respecto a lo anterior, es preciso aclarar que las sequías a diferencia de otros fenómenos naturales se caracterizan por su usualmente cubrir áreas más extensas que sus contrapartes, además que su ocurrencia gradual y paulatina hace difícil determinar su duración absoluta, haciendo de la sequía un fenómeno especialmente susceptible al monitoreo constante. Igualmente la estrecha relación existente entre los fenómenos de sequía y desbarajustes en las condiciones usuales de las diferentes variables del ciclo hidrológico, se hace necesario evaluar las ocurrencia de sequías con el comportamiento de variables como la precipitación, la temperatura superficial, el comportamiento de la vegetación, y la humedad presente en el suelo.\\

  Sin embargo y a pesar de la necesidad de monitoreo constate la evaluación de los fenómenos de sequía se puede verse limitado por la cantidad y calidad de los registros necesarios para evaluarla, además de las limitaciones propias de las aproximaciones utilizadas, donde los indices basados en registros históricos de estaciones en terreno son más precisos pero tienen una cobertura espacial pobre, por su parte las metodologías basadas en sensores remotos cubren grandes áreas utilizando un muestreo espacial mucho mas detallado pero adolecen de imprecisión.\\

  En este orden de ideas en el trabajo aquí descrito adapta una metodología existente en la que a partir del cálculo del índice de precipitación estandarizada no paramétrico en un conjunto de estaciones meteorológicas, se implementan una serie de algoritmos impulsados por datos para la integración e interpolación no lineal de este índice con productos satelitales referentes a diferentes variables del ciclo hidrológico para la derivación de productos del índice de precipitación estandarizado no paramétrico para el departamento de La Guajira consistentes espacial y temporalmente, en las escalas de 3, 6 y 9 meses.\\

  Obteniendo una serie temporal de mapas de SPI para la duración total del estudio, el modelo que mejor se aproximo fue el de XGBoosts con un error cuadrático medio estimado de 0.7 y un error absoluto medio de 0.8; frente a los 0. y 0.9 de Random Forest, mientras que las redes neuronales no consiguieron captar el comportamiento del fenómeno. Estos errores se concentran en la estimación de los valores más altos y más bajos del SPI. Además de un efecto pixelado en la predicción espacial. Finalmente, se midió la importancia de las variables utilizadas en la predicción espacial, obteniendo como variable mas importante la precipitación estimada por satélite (producto CHIRPS), seguida de la temperatura superficial y el indicador NDDI.\\

  Palabras clave: (Sequía, Aprendizaje de Maquina, Modelos Espacio Temporales).


* Abstract
   :PROPERTIES:
  :UNNUMBERED: notoc
  :END:

Droughts are hydrometeorological processes that eliminate or diminish the amount and spatial distribution of precipitation limiting the availability of surface water and/or groundwater, so that much drier conditions than usual occur and are potentially harmful. In the words of the World Meteorological Organization in its Drought Indicators Manual, this natural phenomenon is one of the ones that causes the most economic damage year after year, significantly affecting people’s assets and quality of life. Particularly in Colombia, one of the most vulnerable areas to this phenomenon is the department of Guajira, a department that due to its geographical and social conditions has been historically impacted by this phenomenon.\\


Now, with respect to the above, it is necessary to clarify that droughts, unlike other natural phenomena, are usually characterized by covering more extensive areas than their counterparts, and that their gradual and gradual occurrence makes it difficult to determine their absolute duration, making drought a phenomenon that is especially susceptible to constant monitoring. Likewise, the close relationship between drought phenomena and disturbances in the usual conditions of the different variables of the hydrological cycle, it is necessary to evaluate the occurrence of droughts with the behavior of variables such as precipitation, surface temperature, vegetation behavior, and the humidity present in the soil.\\

However, and in spite of the need of constant monitoring, the evaluation of drought phenomena can be limited by the quantity and quality of the necessary registries to evaluate it, in addition to the limitations of the used approximations, where the indexes based on historical registries of stations in the field are more precise but have a poor spatial cover, on the other hand, the methodologies based on remote sensors cover great areas using a much more detailed spatial sampling but they suffer from imprecision.\\


In this order of ideas in the work described here, a methodology is proposed in which from the calculation of the nonparametric standardized precipitation index in a set of meteorological stations, a series of algorithms driven by data are implemented for the integration and nonlinear interpolation of this index with satellite products referring to different variables of the hydrological cycle for the derivation of products of the nonparametric standardized precipitation index for the department of Guajira consistent spatially and temporally, in the scales of 3, 6 and 9 months.\\

Obtaining a time series of SPI maps for the total length of the study, the model that best approximated was the XGBoosting model with an estimated mean square error of 0.7 and a mean absolute error of 0.8; compared to 0.8 and 0.9 for the random forest, while the neural networks failed to capture the behavior of the phenomenon. These errors are concentrated in the estimation of the highest and lowest SPI values.  In addition to a pixelated effect in the spatial prediction. Finally, the importance of the variables used in the prediction was measured, obtaining as the most important variable the precipitation estimated by satellite (CHIRPS product), followed by the surface temperature and the NDDI indicator. \\


  Key words (Drought, Mahine Learning, Spatio-Temporal Models). \\
# \latex_header: definecolor{gray75}{gray}{0.75}

#+BEGIN_EXPORT latex
\tableofcontents
\listoffigures
\listoftables
#+END_EXPORT

* Introducción
<<secintro>>


Las sequías como fenómenos hidrometeoro-lógicos extremos dependiendo de las condiciones de la zona afectada pueden llegar a tener una incidencia mayor sobre las comunidades que la padecen, sin embargo la caracterización de esta es difícil debido a su comportamiento espacio-temporal sobre amplías zonas y la ausencia de una estrategía de muestro de información que capture la integridad del fenómeno.\\

En el presente trabajo se propone la estimación y monitoreo de parámetros biofísicos relacionados con la sequía utilizando modelos de inteligencia artificial. Se utilizaron datos mensuales desde *1982* hasta *2014*, de precipitación provenientes de estaciones meteorológicas y datos entre el año *2000* y el *2014* de diferentes plataformas espaciales.\\

Provenientes del sensor *MODIS* se seleccionaron los productos satélitales de temperatura superficial, índice de vegetación de diferencia normalizada, índice de vegetación mejorando, índice de área foliar y evapotranspitación.\\

Del producto CHIRPS se obtuvo valores de precipitación en (mm) derivados de satélites con sensores infrarrojos y un conjunto de datos en tierra.\\

El proceso metológico compredió en la identificación, evaluación y selección de imputación de datos, recorte y homogenización de las series de tiempo de todos los datos utilizados y extracción de datos de pixeles en los que se encontraban ubicadas las estaciones meteorológicas. Con los datos de las estaciones meteorológicas se cálculo el índice de precipitación estandarizado (SPI) no paramétrico. Donde además con los datos derivados de los productos satelitales se busco espacializar el indicador SPI mediante experimentos con tres modelos de inteligencia artificial diferentes, red neuronal perceptron multicapa, bosque aleatorio, XGBoosts; para tener en cuenta las particularidades de los datos espaciales y temporales, como los son sus propiedades de autocorrelación espacial y temporal se implementó una metodología llamada validación cruzada espacio-temporal, de modo que los resultados obtenidos fueran realistas y no sobre optimistas.

De modo que el presente documento se encuentra dividido en diferentes capitules, los cuales son Introducción [[secintro]], Planteamiento del Problema [[secpm]], Objetivos [[secobj]], Justificación [[secjust]], Marco Conceptual [[secmc]], Marco Teórico [[secmt]], Marco Referencial [[secmr]], Marco Conceptual [[secmm]], Resultados [[secresult]], Discusión [[secdisc]], Conclusiones [[secconclu]], Observaciones y Recomendaciones [[secobs]], Anexos [[secanex]], Bibliografía [[secbiblio]].

* Planteamiento del Problema
<<secpm>>

Uno de los retos colectivos más desafiantes a futuro, que la humanidad deberá enfrentar es el cambio climático y las consecuencias que este ha traído y traerá; uno de los más preocupantes es que a raíz de este cambio global se están alterando los regímenes de precipitación en todas sus escalas, que conforme a los pronósticos y la opinion general de los expertos es la ocurrencia cada vez mas frecuente y mas extrema de las sequías  \cite{schwalm2017global} .\\

Como lo menciona la Convención de las Naciones Unidas para la lucha contra la Desertificación y la Sequía (UNCCD) las temperaturas más altas, los cambios en los patrones de precipitaciones y la mayor escasez de agua debido al cambio climático alterarán la idoneidad de vastas regiones para la producción de alimentos y la vivienda humana \cite{unccd2017global}. Esto se evidencia en la constante batida de records de temperatura global, año a año. \\

A nivel mundial la situación es preocupante, la ocurrencia de sequías en todo el globo, ha impactado los recursos en países africanos como Somalia, Sudan del Sur, Nigeria y Yemen, afectando un estimado de 20 Millones de personas \cite{Nyt}. Pero la sequía también afecta a países altamente industrializados, en el estado Norteamericano de California recientemente terminó una sequía de seis años, la pero desde que se tienen registros, impactando el estilo de vida y la producción pecuaria de este estado Norte Americano\cite{Nyt}.

En Colombia, una de las zonas que ha sido gravemente afectada por este fenómeno es el Departamento de La Guajira, zona de l país en la que la prolongada sequía de varios años aumento el desabastecimiento de agus y disminuyo los niveles de seguridad alimentaria, afectando unas 63.000 personas \cite{Wfp}, causando además la muerte de unos 4.770 niños entre 2007 y 2015 \cite{DW} .\\

Este territorio tiene dos particularidades que lo hacen altamente vulnerable a las sequías, una es la alta tasa de pobreza que llega al 53.3%, lo que lo convierte en el segundo departamento del país en este sentido \cite{DPS}, y sus condiciones geográficas de ser en buena medida una zona semi-desértica, su clima es árido seco \cite{GLG}, asimismo su hidrografía presenta una muy baja regulación hídrica (es decir muchos causes son temporales) \cite{garcia2014estudio}, limitando la recuperación que puedan tener tanto los ecosistemas como las personas a los fenómenos de sequía. \\

Ahora bien el estudio de la sequía en La Guajira se basa en redes meteorológicas e hidrológicas, en palabras de la Organización Meteorológica Mundial en países en desarrollo suelen tener una densidad de estaciones inadecuada (insuficiente representatividad espacial) para medir los principales parámetros climáticos y de abastecimiento de agua, además la calidad de los datos también es un problema, debido a las lagunas temporales de que adolencen o a la inadecuada longitud de los registros  \cite{wmo2006vigilancia}. Esto se evidencia en la presencia de solo dos estaciones meteorológicas automáticas en el departamento, que se suman a unas 100 estaciones no automáticas, para cubrir un área aproximada de unos 20.848 km².\\

En este orden de ideas la problemática ambiental que genera la ocurrencia de sequías y otras problemáticas ambientales en general, requieren de un intenso trabajo de levantamiento de datos y generación de información que permitan la construcción adecuada y oportuna de medidas de adaptación, y manejo tendientes a tratar el problema.


#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}

* Objetivos
<<secobj>>

** Objetivo General:
Representar el comportamiento espacio temporal de la sequía en el departamento de La Guajira, por medio de técnicas de aprendizaje automático, y haciendo uso de variables biofísicas.\\


** Objetivos Específicos
- Caracterizas las variables que permitan evaluar la sequía en las condiciones semi-desérticas de La Guajira.\\
- Modelar las condiciones de Sequía de La Guajira, por medio de información espacio temporal, entre los años *2000* y *2012*.\\
- Validar los resultados obtenidos con información de estaciones meteorológicas.\\


* Justificación
<<secjust>>

El secretario general de la Organización Meteorológica Mundial, M. Jarraud menciona "A lo largo de la historia de la humanidad, la sequía ha sido uno de los problemas que han afectado a nuestro bienestar y a la seguridad alimentaria" \cite{wmo2006vigilancia}. Sin embargo es necesario precisar que la sequía no es en si misma un desastre, sino que puede llegar a serlo en función de sus efectos sobre la población local, sobre la economía y sobre el ambiente y en función de la capacidad de estos últimos para hacer frente al fenómeno y recuperarse de tales efectos \cite{wmo2006vigilancia}.\\

Para el caso del departamento de La Guajira, este ultimo aspecto, toma preponderancia, pues la población de este departamento tiene unos altos índices de pobreza que llegan al 53% \cite{DPS}. Además la habitan alrededor de 267.000 indígenas wayuu \cite{DPS} que se concentran en las zonas más áridas y secas del departamento por estas mismas condiciones geográficas, este pueblo tiene condiciones de vida nómadas y semi-nómadas, lo anterior es preocupante pues habla de una población con problemas y vulnerabilidades grandes para hacerle frente a los fenómenos de sequía.\\

En este punto cobra importancia la gestión de los riesgos de sequía que tiene por objeto mejorar la capacidad de la sociedad para hacer frente a ese fenómeno, donde la vigilancia y alerta temprana de la sequía son dos componentes importantes en la gestión del riesgos de sequía \cite{wmo2006vigilancia} .\\

En este orden de ideas, los beneficios que trae la implementación de este proyecto son diversos, pues la información generada y comunicada tendrá incidencia en la toma de decisiones.\\

Decisiones sobre la gestión del recurso hídrico, van a permitir la adopción oportuna de medidas para mitigar la desertificación y la sequía impactando a sectores como la agricultura y la ganadería tanto a gran escala como la de subsistencia, además permitir el adecuado manejo de las concesiones de agua de la industria minera del departamento.\\

Permitirá además una mejoría significativa en la planeación y ejecución de obras para la captación y potibilización de agua  \cite{minvivienda},  pues sectorizar las zonas más afectadas por la sequía, en conjunto con otra información como la hidrografía superficial y subterránea (acuíferos), posibilita que estas obras se ubiquen en los lugares con las mejores condiciones, impactando a su vez la calidad y oferta continua del recurso hídrico. \\

Por otro lado decisiones en cuanto a política pública, guiados por este estudio de la mano de la previsión y las alertas sobre las condiciones de sequía facultaría al Estado para mitigar los efectos de las sequías en la salud de la población por medio de campañas que minimicen cifras como la de menores muertos, igualmente políticas públicas tienen el potencial de impactar positivamente sobre los medios de subsistencia de la población para que se adapten mejor a las condiciones secas.\\




* Marco Conceptual
<<secmc>>

** Sequía
<<secdef>>

La sequía es un fenómeno hidrometeorológico, en el que a raíz de un déficit en la disponibilidad del recurso hídrico desencadenado por una baja relativa respecto a los niveles promedio de la precipitación, se genera una perturbación generalizada en todas las partes constituyentes del ciclo hidrológico, afectando una región geográfica particular, durante un intervalo de tiempo acotado. \\

Un aspecto importante a tener en cuenta es que a diferencia de otros fenómenos naturales causantes de desastres, las sequías son acontecimientos que se desarrollan de manera lenta en el tiempo y extendida en el espacio, es decir su formación se ve en términos de semanas y meses, en casos extremos en años (no confundir con desertificación). \\

En consecuencia, la sequía es un fenómeno hidrológico incluido en el contexto del ciclo hidrológico, y dada su ocurrencia, sus efectos se van propagando en cada parte del sistema, tomando diferentes denominaciones según la clase de recurso hídrico impactado, a continuación se describen los tipos de sequía mas aceptados en la literatura y en particular se señala la variable del ciclo hidrológico afectada. \\

*** Sequía Meteorológica
<<seqmeteo>>

Este tipo de sequía es el más común y se caracteriza por ser la primera en manifestarse, podría definirse como un déficit de precipitación prolongado por cierto periodo de tiempo respecto al comportamiento normal o promedio de la zona geográfica de estudio.\\

*** Sequía Agrícola
<<seqagri>>
Esta se presenta como consecuencia de la anterior y en esta se evidencia como la falta de agua precipitada disminuye la cantidad de agua almacenada en el suelo (humedad del suelo), afectando así la disponibilidad del recurso hídrico en la zona de raíces para las plantas y cultivos; lo clave en este tipo de sequías es la modelación de la humedad del suelo, y el estrés hídrico de las plantas.[fn:4] \\



*** Sequía Socio-económica
<<seqecono>>

Finalmente, la afectación sufrida por la sociedades humanas generada por un fenómeno de sequía se denomina sequía socio-económica, y su impacto se puede vislumbrar en como la falta del recurso hídrico altera el desempeño normal de las personas, es la más difícil de modelar por que afecta temas como la provisión de servicios públicos, limitaciones a las industrias en la producción por falta de agua, entre muchos otros. Y no solo depende de las condiciones naturales sino que también inciden variables como la resiliencia de las comunidades o el sector económico estudiado.[fn:4] \\


# defino detalladamente los tipos de datos
Los sensores remotos y las rachas de datos hidrometeorológicos son la forma es que se recolecta la información necesaria para modelar la sequía, en este contexto estas se definirán a continuación.\\




** Rachas de datos hidrometeorológicos

Las rachas de datos hidrometeorológicos se refieren a datos climáticos u ambientales tomados en campo con el objetivo de estudiar o monitorear un fenómeno bio-físicos que pueden ser muy distintas mediciones con muy diferentes estrategias de medición. Eso sí dadas las características de la sequía como se menciona en la sección  [[modseq]], es preciso usar variables ambientales relacionadas con el ciclo hidrológico, mas aún dados los largos periodos de retorno de la sequía, es preponderante que los registros sean de la más larga duración posible, registros de variables como la precipitación, la temperatura y la evapotranspitación (por poner algunos ejemplos) de las estaciones climatológicas e hidrometeorológicas de una zona geográfica en particular. \\

** Sensores Remotos
<<secsr>>

Los sensores remotos son en su definición mas general todos aquellos instrumentos capaces de obtener información sobre un objetivo de manera indirecta o a distancia; no obstante la clase específica de sensores remotos útiles para el estudio de la sequía se refiere usualmente a sensores transportados en vehículos satelitales, el estudio de las diferentes variables bio-físicas a través de dichos sensores se conoce por diferentes nombres, sensores remotos o teledetección en la literatura norteamericana u observación de la tierra en la literatura europea[fn:5].\\

Ahora bien de forma más formal la  *Teledetección* es el proceso de detección y monitoreo de características físicas de un cuerpo mediante la medición de la radiación reflejada, emitida o dispersada por este[fn:6][fn:7][fn:8] \cite{schwalm2017global}.\\

#+CAPTION: Ejemplo de como es el muestreo de información realizado por un sensor remoto.
#+ATTR_LATEX: :width 8cm
#+LABEL: fig:AQUA2
[[~/Dropbox/0_Tesis/imagenes/AQUA2.png]]

Una característica importante del tipo de información básica derivada de sensores remotos es que por sus características intrínsecas como la distancia entre el sensor y el objetivo, el intervalo de tiempo entre observaciones o las longitudes de onda utilizadas para caracterizar la cubierta observada se suele clasificar los datos de acuerdo a las siguientes categorías.\\

- *Resolución Espacial* esta se refiere a el tamaño mínimo del objetivo que un sensor puede caracterizar individualmente, es expresada usualmente como el tamaño del pixel sobre el terreno, cuyas unidades son metros.\\

#+CAPTION: Resolución Espacial
#+ATTR_LATEX: :width 8cm
#+LABEL: fig:rasters-are-pixels
[[~/Dropbox/0_Tesis/imagenes/rasters-are-pixels.png]]

- *Resolución Temporal* esta se refiere a el intervalo de tiempo entre tomas por parte del sensor, dada la ubicación de estos sensores en orbita terrestre solo es posible sensar un objetivo con las mismas condiciones cada cierto intervalo de tiempo, cuyas unidades son días o minutos.\\

  En particular la resolución espacial y temporal tienen una relación inversamente proporcional, entre mas alta la resolución espacial, mas baja es la temporal; sin embargo esto evoluciona con los nuevos desarrollos en instrumentación.\\

- *Resolución Espectral* esta se refiere a la parte del espectro electromagnético que es observada por el sensor, usualmente son unas cuantas franjas estrechas, cuyas unidades son micrómetros.\\

  En particular los sensores usados en el presente trabajo toman información en longitudes de onda de la zona visible, infrarrojo cercano e infrarrojo térmico.\\

#+CAPTION: Espectro Electromagnético
#+ATTR_LATEX: :width 8cm
#+LABEL: fig:rasters-emspectrum
[[~/Dropbox/0_Tesis/imagenes/rasters-emspectrum.png]]


- *Resolución Radiométrica* esta se refiere al nivel de detalle con el que el sensor es capaz de discernir entre dos diferentes respuestas, es decir que tan sensible es a los cambios en la señal, se suele medir en el número de bits en los que el sensor graba la información captada.\\

  Esta resolución también a ido evolucionando en el tiempo y usualmente los sensores más modernos tienen mayores capacidades.\\


** Modelamiento de Sequías
<<modseq>>

# defino por la sequia es dificil de modelar
Es preciso aclarar que las sequías se constituyen en uno de los peligros naturales más costosos económicamente hablando además de ser uno de los técnicamente mas desafiantes  \cite{svoboda2016handbook}; puesto que las zonas afectadas usualmente cubren áreas mucho mas extensas que la de otros fenómenos naturales considerados desastres (por ejemplo un inundación), sumado a el hecho de que su ocurrencia es gradual o paulatina, esto la hace especialmente susceptible al monitoreo constante  \cite{svoboda2016handbook}. \\

# introduzco las estrategias para modelar la sequia
Ahora bien desde el punto de vista del modelamiento del fenómeno, y haciendo énfasis en las características de este, entre otras un comportamiento altamente variable tanto en el espacio, como en el tiempo; Dada la complejidad señalada, y con el objetivo de usar una métrica resumen del comportamiento del fenómeno se han desarrollado y adoptado según el caso diferentes índices para medir el comportamiento de la sequía. \\

Podemos dividir estos índices en dos grandes familias, los índices relacionados a las rachas de datos hidrometeorológicos y aquellos que tienen su origen en datos derivados de teledetección espacial.\\


# modelamiento temporal o clasico
Para empezar los índices basados en rachas de datos hidrometeorológicos, usualmente desarrollan diferentes técnicas de transformación, ponderación, y estandarización de variables relacionadas al ciclo hidrológico \cite{CaracterizacionSequias}. Entre los indicadores mas utilizados encontramos el Índice de Precipitación Estandarizado o *SPI*, y el *Índice de Sequía de Palmer*. El primero es un tipo de estandarización de la precipitación, y es usado para el modelamiento de sequías meteorológicas, el segundo mas complejo que el anterior usa una aproximación a un balance hídrico sobre la zona de estudio.\\

# adolencen estos metodos
Ahora bien, este tipo de aproximaciones tienen varias limitaciones, la principal recae sobre la disponibilidad y calidad de los datos necesarios para calcular los índices, esta es los periodos de retorno propios del ciclo hidrológico, por lo que es necesario que las rachas de datos tenga un mínimo de 30 años continuos.\\

Por otro lado, dado que estos índices de sequía son cálculados, en base a datos de estaciones meteorológicas o hidrológicas, también es cierto que las estimaciones son confiables en el punto exacto en el que se muestreo la información. Por lo que la información de la sequía carece de una dimensión espacial.\\

# geoestadistica como estrategia para espacializar
Para esto ultimo, se han aplicado estimaciones basadas en una rama de la estadística llamada geo-estadística, que tiene entre otros como objetivo estimar los valores de una variables en el espacio dado un muestro espacial. Sin embargo la precisión de estas aproximaciones no es la deseable. \\

# modelamiento por radiación electromagnética
Por otro lado, y desde los años ochentas, se han desarrollado, pero sobretodo adaptado índices basados en la teledetección como aproximación a la sequía, dada la capacidad de la teledetección para capturar información relacionada con el contenido de clorofila, humedad de la hoja o temperatura de la superficie \cite{CaracterizacionSequias}.\\

Uno de los indicadores clásicos para seguir el comportamiento del estado vegetativo de las plantas en el /Índice de Vegetación Normalizado/ o *NDVI*, variaciones de este como el /Índice de Vegetación Mejorado/ también son ampliamente usados. Otros como el /Índice de Área Foliar/ o el /Índice de Agua Normalizado/ o el /Índice de Sequía Normalizado/ pueden ser buenos descriptores del comportamiento de la sequía.\\

Sin embargo , los datos remotamente sensados, pueden ser usados como entrada para complejos modelos de inversión de la transferencia radiativa y calcular otro tipo de variables de interés como lo son la Temperatura Superficial o *LST* por sus siglas en ingles (/Land Surface Temperature/) o incluso estimaciones de la /Evapotranspiración/ (*ET*) o incluso estimaciones de la precipitación.\\

Sin embargo estos métodos usualmente adolecen precisiones altas para caracterizar el comportamiento de la sequía.\\


# Fin de los metodos clasicos
Ahora bien, el paso lógico seria mezclar información proveniente de las rachas hidrológicas y de los datos remotamente sensados para obtener productos de sequía operacionales con una alta precisión y una distribución homogénea en el espacio. Sabido que no existe una manera obvia de combinar estas fuentes de datos y de su comportamiento no lineal, el uso de métodos impulsados por datos puede ser una manera factible de combinar esta información.\\

** Técnicas basadas en modelos impulsados por datos para el modelamiento de Sequías

Los modelos impulsados por datos son una familia de modelos y/o algoritmos capaces de establecer relaciones entre distintas variables y adaptarse de acuerdo al fenómeno estudiado, esta flexibilidad los hace atractivos para entre otras cosas servir de puente entre los diferentes tipos de datos recolectados para modelar la sequía y fusionarlos de manera que se explote los puntos fuertes de cada estrategia y se cubran los puntos débiles.\\

Genéricamente los modelos impulsados por datos son conocidos como "/Inteligencia Artificial/", y se corresponde con el estado actual del intento de la humanidad por sintetizar su propia inteligencia, ahora bien los modelos impulsados por datos son un conjunto enorme de algoritmos y modelos matemáticos, alimentado por otras ramas del saber, entre sus grandes a portantes tenemos a el /Aprendizaje Estadístico/ y el /Aprendizaje de Maquina/.\\

Actualmente varios de los algoritmos desarrollados en esta rama del saber se encuentran en desuso, y la mayoría de los esfuerzos se centran en dos grandes familias, los algoritmos basados en arboles de decisión, y los algoritmos basados en redes neuronales artificiales, en particular un sub-grupo de estos modelos conocido como /Aprendizaje Profundo/, ha recibido mucha atención desde el 2014 año en el que se empezó a popularizar en el campo de la visión por computador; sin embargo este se encuentra por fuera del alcance de este trabajo.\\



* Marco Teórico
<<secmt>>

Continuando con el capitulo anterior la Parte [[secmc]] donde se presentan algunas definiciones sobre los temas que se tocan en este documento, procederemos a formalizar teóricamente dichas definiciones relevantes.

** Sequía
# Aproximacion matematica a la sequia definir SPI y SPI no estandarizado
Para empezar y recapitulando en la sección [[secdef]] la sequía es básicamente una perturbación sobre el ciclo hidrológico, la aproximación mas obvia a la sequía meteorológica es medir la perturbación del agua precipitada sobre la región de estudio. \\

Existen distintas maneras de modelar la perturbación o el déficit de la precipitación sin embargo la Organización Meteorológica Mundial recomienda el uso de entre otros el Índice de Precipitación Estandarizado o *SPI*, este fue introducido por investigadores de la Universidad Estatal de Colorado \cite{mckee1995drought}. y fue diseñado para cuantificar los déficits de precipitación a partir de una serie o racha de datos de precipitación medido continuamente por al menos 30 años.\\

Los posibles valores del SPI y su interpretación se listan en el cuadro [[tab:spi]].

#+tblname: tab:spi
#+CAPTION: Valores de Referencia del SPI\\
#+ATTR_LATEX: :align |l|r|
|--------------------+-------------------------|
| Valor SPI          | Intensidad de la Sequía |
|--------------------+-------------------------|
| SPI > 2.0          | Severamente Húmedo      |
| 1.5 < SPI <= 2.0   | Moderadamente Húmedo    |
| 1.0 < SPI <= 1.5   | Anormalmente Húmedo     |
| 1.0 <= SPI <= -1.0 | Normal                  |
| -1.5 <= SPI -1.0   | Anormalmente Seco       |
| SPI < -2.0         | Severamente Seco        |
|--------------------+-------------------------|

Para obtener el SPI original, se aplica el siguiente algoritmo a partir de los registros de precipitación, agregados en ventanas de 3, 6 o 9 meses comúnmente, luego se realiza la visualización en frecuencia de la precipitación acumulada.

Luego se verifica empíricamente que la precipitación no sigue una distribución normal o gaussiana, por lo que se aplica la siguiente ecuación [[eqn:gaussiana]] que corresponde a la función de densidad gamma \cite{fonnegra2017desarrollo}.\\

#+NAME: eqn:gaussiana
\begin{equation}
g(x) =  \frac{ 1 }{  \beta^{\alpha} \gamma(\alpha) } x^{\alpha - 1} e^{\frac{-x}{\beta} }, (x > 0)
\end{equation}

donde $\alpha$ es un parámetro de ajuste ($\alpha > 0$), $\beta$ es un parámetro de escala ($\beta >0$) y $x$ la cantidad de precipitación acumulada ($x>0$). De manera que la probabilidad acumulada de precipitación para una escala de tiempo dada es de ([[eqn:prob]]):


#+NAME: eqn:prob
\begin{equation}
G(x); \int_{0}^{x} g(x)dx = \frac{ 1 }{  \beta^{\alpha} \gamma(\alpha) } = \int_{0}^{x} x^{\alpha - 1} e^{\frac{-x}{\beta} } dx
\end{equation}

Los parámetros de forma y escala ([[eqn:forma]], [[eqn:escala]]) se calculan usando las siguientes ecuaciones. \\

#+NAME: eqn:forma
\begin{equation}
\alpha = \frac{ 1 + \sqrt{(1 + \frac{ 4 * A }{3} )} }{ 4 * A}
\end{equation}

#+NAME: eqn:escala
\begin{equation}
\beta = \frac{\Bar{x}}{\alpha}
\end{equation}


Que a su vez dependen de una variable auxiliar definida por ([[eqn:aux]]):\\

#+NAME: eqn:aux
\begin{equation}
A = ln(\Bar{x}) - \frac{\sum ln (x)}{n}
\end{equation}


Donde n es el número de precipitaciones observadas y \Bar{x} es el promedio de la precipitación bajo la escala de interés \cite{fonnegra2017desarrollo}.\\


Dado que es posible que exista una precipitación de cero y la función gamma es indefinida para este valor, se aplica un factor de corrección al ajuste que depende de la precipitación nula. Donde la probabilidad acumulada total es de: ([[eqn:corr]])\\

#+NAME: eqn:corr
\begin{equation}
H(x) = q + (1 - q ) G(x)
\end{equation}

Donde q  es la probabilidad de que ocurra un cero y este se calcula como \(q= m/n\), siendo \(m\) el número de ceros en la serie de tiempo n. Por otra parte \((1-q)\) es la probabilidad de que no ocurra un cero \cite{fonnegra2017desarrollo}.\\

Ahora como para transformar esta función de densidad de probabilidad 	acumulada a la distribución normal, se aplica la siguiente ecuación ([[eqn:densidad]]):

#+NAME: eqn:densidad
\begin{equation}
H(x) = \frac{1}{\sqrt{2 \pi}} \int_{\infty}^{x} e^{\frac{-t^2}{2}}dt
\end{equation}

Dándose dos posibles casos de solución:\\


- Caso 1: 0 < H(x) \leqslant 0,5.

#+NAME: eqn:caso11
\begin{equation}
SPI = -( t - \frac{c_0 + c_1 t + c_2 t^2}{1 + d_1 t + d_2 t^2 d_3 ^t3})
\end{equation}

#+NAME: eqn:caso12
\begin{equation}
t = \sqrt{-2 * ln (H(x))}
\end{equation}

- Caso 2: 0.5 < H(x) \leqslant 1.


#+NAME: eqn:caso21
\begin{equation}
SPI =  t - \frac{c_0 + c_1 t + c_2 t^2}{1 + d_1 t + d_2 t^2 d_3 ^t3}
\end{equation}

#+NAME: eqn:caso22
\begin{equation}
t = \sqrt{-2 * ln(1-    H(x))}
\end{equation}


Con valores de constantes de: $c_0$ = 2,515517, $c_1$ = 0, 802853, $c_2$ = 0,010328, $d_1$ = 1, 432788, $d_2$ = 0,189269, $d_3$ =0, 001308 \cite{fonnegra2017desarrollo}.\\

Sin embargo este indicador adolece de algunas propiedades necesarias para su aplicación sobre extensas áreas geográficas. Entre estas la precipitación se constituye en el único dato de entrada del indicador, dejando de lado variables relevantes como lo son la temperatura, o la humedad del suelo \cite{svoboda2016handbook}.\\



Otra variable importante a tener en cuenta es la longitud mínima de registro necesaria para la aplicación de este índice que viene a ser de no menos de 20 años, y se recomiendan al menos 30 sin embargo en paı́ses en desarrollo como el que nos atañe estos registros son más bien escasos  y además de eso la consistencia de los datos usualmente no es la idónea y se presentan periodos de tiempo sin registros, o registros erróneos debido a daños en los sensores.\\


Finalmente la debilidad más importante del SPI en su cálculo ordinario presupone que el registro en frecuencia de la precipitación se ajusta a una distribución de probabilidad usualmente la distribución gamma, sin embargo y especialmente cuando existen áreas extensas y comportamiento climático variado se puede dar el caso que diferentes distribuciones de probabilidad se ajusten a diferentes condiciones climato-geográficas o sencillamente que el supuesto no se cumpla.\\


Esta última dificultad fue abordada en el año 2014 por dos investigadores de la universidad del California Irvine \cite{farahmand2015generalized}, que propusieron un marco general para la derivación de indicadores de sequía no paramétrica estandarizada.\\


Para esto los autores proponen sustituir el ajuste de una distribución de probabilidad (gamma en el ejemplo anterior), por una función de probabilidad empı́rica, por medio de un método llamada empirical gringorten plotting position. Lo anterior expresado de una forma más formal, se describe en la siguiente sección:\\


Partiendo de la ecuación (5 -8 [[eqn:gaussiana]] ), el método propone reemplazar la función gamma por la posición de graficación de 	gringorten denotada por ([[eqn:prob2]]):\\

#+NAME: eqn:prob2
\begin{equation}
p(X_i) = \frac{i - 0.44}{n + 0.12}
\end{equation}

donde n denota el tamaño de la muestra, i denota el rango de la precipitación no cero, y p(xi) corresponde a la probabilidad empírica. Usando esta aproximación empírica	no necesita de la ecuaciones (5-14, 5-15, 5-16, 5-17, 5-18 )  ([[eqn:densidad]],[[eqn:caso11]],[[eqn:caso12]],[[eqn:caso22]])
para derribar probabilidades empíricas la salida de la ecuación p(X)puede ser transformada en un índice estandarizado mediante la siguiente ecuación ([[eqn:si]]):\\

#+NAME: eqn:si
\begin{equation}
SI = \phi^{-1} (p)
\end{equation}


donde \phi corresponde a la función de distribución normal  y p es la probabilidad derivada de (5 - 19 [[eqn:prob2]]) También se pueden estandarizar los percentiles utilizando la siguiente aproximación comúnmente utilizada ([[eqn:si2]]).\\


#+NAME: eqn:si2
\begin{equation}
SI = \left\{
    \begin{array}{ll}
-( t - \frac{c_0 + c_1 t + c_2 t^2}{1 + d_1 t + d_2 t^2 d_3 ^t3}) si 0 < p 	\leq 0.5 \\
t - \frac{c_0 + c_1 t + c_2 t^2}{1 + d_1 t + d_2 t^2 d_3 ^t3}  si 0.5 < p 	\leq 1
    \end{array}
    \right.
\end{equation}

donde \(c_0 = 2.515517; c_1 0.802583; c_2 = 0:010328; d_1 1.432788; d_2 = 0.189269; d_3 = 0.001308\) \\




** Modelos

Ahora bien, las aproximaciones matemáticas a la hora de modelar el comportamiento de la sequía dependen en buena medida del tipo de mediciones que se estén utilizando para su caracterización, distinguiremos dos tipos de datos, los datos de rachas hidrometeorológicas en este caso de precipitación, con dos sub casos el análisis temporal y el análisis espacial de estos; por otro lado distinguiremos los datos provenientes de sensores remotos.\\


*** Datos /in situ/

Las rachas de datos hidrometeoro lógicos /in situ/ por sus características intrínsecas es posible realizar ciertas modelaciones


**** Series de Tiempo

Primeramente una *Serie de Tiempo* es posible definirla como una serie de puntos indexados en el tiempo, que cumplen la propiedad de que los intervalos temporales en los que se toman las medidas son constantes y dotados de una dependencia estadística entre unos y otros.\\

La dependencia puede ser definida como la relación lineal entre una serie y una versión retrasada de sí misma en el tiempo, también conocida como auto-correlación temporal. Esta ultima puede ser expresada matemáticamente por medio de la Función de Auto-correlación (/ACF/ [[eqn:ACF]] por sus siglas en ingles), que es descrita matemáticamente mediante la siguiente ecuación:\\

#+NAME: eqn:ACF
\begin{equation}
p(s,t) = \frac{\gamma(s,t)}{\sqrt{\gamma(s,t) \cdot \gamma(t,t)}}\\
\end{equation}



Dada la auto-correlación temporal de las series de tiempo, estas tienden a tener comportamientos mas o menos cíclicos, dichos comportamientos pueden dividirse en tres elementos constituyentes para facilitar su modelamientos, y pueden ser
.


#+NAME: eqn:tdc
\begin{equation}
Y (t) = T (t) + S (t) + e (t)
\end{equation}

La tendencia se refiere a el crecimiento, decrecimiento o estancamiento de la serie a lo largo de toda la ventana temporal de estudio y se puede definir matemáticamente como :

#+NAME: eqn:tendencia
\begin{equation}
\widehat{T}_{tendencial}   = \frac{1}{m} \cdot \sum_{k=-k}^{k} y_t + j,
\end{equation}

Por su parte la estacionalidad, se refiere a los ciclos cuasi-repetitivos de una serie temporal dada, definiéndose matemáticamente como:

#+NAME: eqn:estacionalidad
\begin{equation}
\widehat{T}_{t estacional} = \frac{1}{8}y_{t-2} +\frac{1}{4}y_{t-1} + \frac{1}{4}y_{t} + \frac{1}{4}y_{t+1} + \frac{1}{4}y_{t+2}
\end{equation}

El ultimo componente es la aleatoriedad de la serie temporal, definido como $e(t)$ y como su nombre lo dice tiene un comportamiento aleatorio.

El planteamiento anterior de las series temporales, puede ser usado para la imputación de datos faltantes, en particular para el método /Seasonally Decomposed Missing Value Imputation/.\\

Este método funciona bajo el supuesto de que la serie puede ser caracterizada por los tres anteriores elementos constituyentes, y estima un valor faltante de una serie temporal dado en un tiempo dado, según el valor de la tendencia y la estacionalidad, y calcula el error de esta estimación como:\\

#+NAME: eqn:error
\begin{equation}
\widehat{T}_{t error} = \widehat{T}_t - (\widehat{T}_{ tendencial} + \widehat{T}_{t estacional})
\end{equation}

Finalmente asigna o imputa el valor faltante según la siguiente ecuación:

#+NAME: eqn:descomposicion
\begin{equation}
X (t) = T (t) + S (t) + e' (t)
\end{equation}

Donde $T$ corresponde a la tendencia de la serie, $S$ corresponde a la estacionalidad y $e'$ es un valor aleatorio para un tiempo $(t)$.

**** Geoestadística

Similar a auto-correlación temporal, las mediciones tomadas en el espacio también tienden a correlacionarse entre ellas, esto se conoce como auto-correlación espacial y es una propiedad que nos dice que los valores medidos geográficamente más próximos tienden a ser mas similares entre sí que aquellos tomados a distancias muy largas.\\

Aunque existen distintas maneras de modelar este comportamiento en este documento mencionaremos únicamente a el *Índice de Moran*. Formalmente el coeficiente de Auto-correlación espacial Global de Moran o *I* es un índice que evalúa la extensión de la autocorrelación espacial entre un conjunto de celdas o pixeles $n = x_i$ localizado en áreas contiguas, donde $_i$ es el rango í-esimo o el valor de $X$.\\

#+NAME: eqn:moran
\begin{equation}
I = \frac{\sum_{i}\sum_{j} W_{i j} C_{i j}}{s^2 \sum_{i}\sum_{j} W_{i j}}
\end{equation}

Donde $w_{ij} = 1$ si la celda $i$ y $j$ son vecinas, de otro modo $w_{ij} =0;$ y $c_ij = (X_i -) (X_j -)$ son variables, en particular y otra locación respectivamente.\\


#+NAME: eqn:s
\begin{equation}
S^2 = \frac{\sum_{i = 1}^{n} (X_{i} - \Bar{X})^2}{n}
\end{equation}

Los valores positivos del Índice de Moran indican similitud entre los vecinos, los valores negativos indican que los valores de puntos cercanos son disímiles y finalmente los valores cercanos a cero indican que se trata de un proceso aleatorio no modelable por medio de técnicas de interpolación.\\


Existen distintas metodologías uq explotan la propiedad de la auto-correlación espacial para la predicción de locaciones desconocidas en el espacio, sin embargo, esto no se abordara en el presente documento.\\

*** Remotamente Sensados

Como se menciono anteriormente (en la sección [[secsr]]) los sensores remotos son útiles para derivar indicadores relacionados con la sequía, en particular hay dos tipos de variables derivadas de la teledetección que son útiles, los índices de vegetación relacionados con el estado vegetativo de las plantas y otras variables relacionadas con el ciclo hidrológico.\\


**** Índices de basados en teledetección

La primera familia de variables descriptoras de la sequía encontramos una de las ramas de la teledetección mas clásicas y con mas historia los índices de vegetación.\\

Estos son combinaciones inteligentes usualmente normalizadas de diferentes longitudes de onda usadas para caracterizar el estado vegetativo de las plantas.\\

Uno de los más antiguos y ampliamente utilizado es el índice normalizado de vegetación \cite{chuvieco1996fundamentos}, este índice explota el hecho de que el estado vegetativo de la planta esta íntimamente ligado a la respuesta de la reflectancia en los rangos del rojo e infrarrojo cercano. Definiéndose matemáticamente como:\\

#+NAME: eqn:ndvi
\begin{equation}
NDVI = \left( \frac{\rho_{nir} - \rho_{rojo} }{ \rho_{nir} + \rho_{rojo}} \right)
\end{equation}

Donde $\rho_{nir}$ corresponde a una reflectancia dada en el infrarrojo cercano y $\rho_{rojo}$ a una reflectancia en el rojo.\\

Ampliamente utilizado dada su sencillez, y su sensibilidad a los cambios en el contenido de clorofila de las plantas \cite{fonnegra2017desarrollo}.


En el NDVI en particular se han detectado algunos problemas de saturación con la vegetación densa, es decir el indicador pierde la capacidad de discriminar cuando las concentraciones de material vegetal son altas, existen distintas propuestas para reemplazar este indicador y evitar estos problemas de saturación, el mas importante es quizás el índice de vegetación mejorado, descrito con la siguiente ecuación.\\

#+NAME: eqn:evi
\begin{equation}
EVI = \left( \frac{\rho_{nir} - \rho_{rojo} }{ L + \rho_{nir} + c1 * \rho_{rojo} + c2 * \rho{azul}} \right)
\end{equation}

Donde $\rhon{nir}, $\rhon{rojo} $\rhon{azul}$ se refieren a las reflectancias en las longitudes de onda roja, infrarroja y azul respectivamente y $L$ corresponden a unas constantes, L es un factor de corrección asociado a la contaminación de la señal por la reflectividad del suelo, y los parámetros $c1 y c2$ son parámetros de corrección de los efectos atmosféricos sobre la longitud de onda roja y azul.\\

Por otro lado tenemos algunos índices relacionados la humedad de las cubiertas observadas, tenemos por ejemplo el índice dea agua normalizado, definido por la siguiente ecuación.\\

#+NAME: eqn:ndwi
\begin{equation}
NDWI = \left( \frac{\rho_{nir} - \rho_{swir}}{ \rho_{nir} + \rho_{swir}} \right)
\end{equation}

Donde $\rho_{nir} y \rho{swir}$ corresponden a la reflectancia en la longitud de onda del infrarrojo cercano y el infrarrojo de onda corta.\\

Finalmente, realizando una combinación normalizada del comportamiento de la vegetación derivada del NDWI y de la humedad de las cubierta caracterizada por NDWI, se ha propuesto el índice de sequía normalizado, definido por la siguiente ecuación.\\

#+NAME: eqn:nddi
\begin{equation}
NDDI = \left( \frac{NDVI - NDWI}{ NDVI + NDWI} \right)
\end{equation}


**** Productos derivados de datos satelitales

Por otro lado es también posible derivar información de sensores remotos utilizando relaciones mas complejas que las estandarizaciones entre longitudes de onda vistas anteriormente. Estos métodos usualmente se derivan de modelos de transferencia radiativa y la inversión de los mismos, en algunos casos usan estos modelos como entrada a modelos de balance hídrico o de flujos de carbono, dependiendo de la aplicación.\\

En este trabajo se utiliza la temperatura superficial (LST), Evapotranspiración (ET), Índice de Área Foliar (LAI) y el producto de precipitación CHRIPS como datos derivados de productos satelitales.\\

Son métodos bastante complejos, por lo que estos solo se métodos solo se mencionan y se recomienda la lectura del respectivo Documento de Bases Teóricas del Algoritmo (ATBD por sus siglas en ingles /Algorith Theorical Basis Document/) de cada producto si se desea profundizar.\\

*** Modelos Impulsados por datos

A continuación introduciremos teóricamente formalmente los algoritmos utilizados en el presente trabajo, estos algoritmos hacen parte de una rama del conocimiento llamada /Machine Learning/ o Aprendizaje automático, una sub-rama de la inteligencia artificial.\\

Para empezar el /Machine Learning/ es un conjunto de estrategias, técnicas y métodos, tanto teóricos como practicos que tratan de abordar problemas complejos que /a priori/ no son facilmente programables o pueden ser llevados a cabo por un sistema experto. El ejemplo clasico es el reconocimiento de rostros en una imagen, es sumamente complicado imaginar una serie de reglas absolutas para generar un algoritmo capaz de reconocer caras en una fotografía.\\

La forma de abordar los problemas por parte del /machine learning/ tambien es diferente, usualmente en las metodologías clásicas se optaba por construir el modelo mas simple posible que pudiese resolver un problema dado; dando como resultado la preponderancia de modelos líneales por su simplicidad y por sobre todo la capacidad explicativa de esta familia de modelos.\\

*Regla de Predicción*\\

Esta idea es, sin embargo, descartada por completo por la aproximación basada en /machine learning/ puesto que la idea aquí es encontrar una regla de predicción entre un conjunto de variables predictoras  y una o varias variables a predecir. Según la siguiente ecuación\\

#+NAME: eqn:reglapred1
\begin{equation}
f: \mathbb{R}^{d} \to   \mathbb{R}
\end{equation}


#+NAME: eqn:reglapred2
\begin{equation}
*x* \mapsto y
\end{equation}


*Aprendizaje Supervizado*

Donde la estrategia para encontrar esta regla de predicción se basa en minimizar una función de perdida entre el resultado obtenido y el resultado deseado, ajustando un conjunto de hiperparametros \theta que controlan el comportamiento de la función de predicción hallada.  \\

La estrategia  anteriormente descrita se conoce como aprendizaje supervisado, y es la estrategia de /machine learning/ mas relevante hoy en día, mas no la única[fn:13].

Existen una enorme variedad de algoritmos desarrollados en el marco anteriormente mencionado, sin embargo existen dos grupos o familias de modelos que resaltan y que abordaremos a continuación.\\

**** Arboles de Decisión

Los arboles de decisión, o CART es un algoritmo diseñado para la generación automática de un grafo capaz de representar la complejidad de un conjunto de datos mediante su división a diferentes niveles en dos nodos hijos  a partir de escisiones numéricas repetidamente. Ahora bien, la idea del crecimiento de un árbol es escoger la división ente todas las posibles divisiones en la que los datos del nodo hijo sean los más puros posibles.\\

La formulación de este algoritmo también denominado el proceso de crecimiento de un árbol puede dividirse en cuatro pasos y estos son:\\

- Selección de Caracteristicas:\\

  En este paso se selecciona una característica o variable descriptor que será usada en este nivel para dividir el conjunto de datos, de acuerdo a la varianza de cada variable independiente.\\

- Condiciones de División:\\
  En el siguiente paso se una el error medio cuadrático de todas las muestras que caen en dicho nodo para determinar qué tan válido ha sido la división escogida.\\

- Condiciones de Parada:\\

  + Sí, un nodo se convierte en puro es en todos los casos en el nodo tiene un valor idéntico a la variable dependiente, así que el nodo no será dividido.\\
  + Sí en todos los casos tienen valores idénticos para cada predictor, el nodo no será dividido.\\
  + Sí el tamaño del nodo es menor que el especificado por el usuario, el nodo no será dividido.\\
  + Sí el nodo resultado es hijo de un nodo cuya talla es menor que la especificada por el usuario el nodo no será dividido.\\

- Poda

  Un árbol mal configurado o sin criterios de parada adicionales, puede llegar a sobre ajustarse a los datos de entrada, por lo que algunos autores usan técnicas de podado de árboles, sin embargo estas no son consideradas en el presente trabajo.\\



**** Bosque Aleatorio

	#+CAPTION: Representación del Funcionamiento del algoritmo Bosque Aleatorio
    #+ATTR_LATEX: width=0.9\textwidth
    #+LABEL: fig:RF
    [[/home/juanse/Dropbox/0_Tesis/imagenes/RF.png]]

Los arboles de decisión por su diseño mismo tienden a sobre entrenarse sobre los datos de entrenamiento, este comportamiento también conocido como "memorización" de los modelos.\\

Para evitar esto una propuesta interesante que mejora a los CART, es el bosque aleatorio o /Random Forest/ este algoritmo introduce dos cambios importantes para evitar el sobre entrenamiento.\\

El primero y mas importante es el Impulso o /Boosting/
este se basa en la idea de que la combinación de muchos modelos debiles puede dar como resultado un modelo fuerte. Estos modelos débiles son de hecho CART individuales.\\

Ahora bien para evitar que estos modelos débiles sean muy similares entre sí, se introduce el otro gran cambio y este es el Embolsado o /Bagging/ este consiste en entrenar cada uno de los modelos débiles sobre un sub-conjunto único de los datos de entrenamiento.\\

La generación de un conjunto de arboles entrenados en sub-conjuntos de datos diferentes y que las decisiones se realizan en base a el voto de la mayoría, es lo que consiste el algoritmo de bosque aleatorio. \\



**** Aumento Extremo del Gradiente

El algoritmo de Bosque Aleatorio es un algoritmo famoso y ampliamente utilizado en distintos contextos, no solo a nivel experimental, sino que también en producción, ejemplos de esto son la cadena de clasificación de imágenes de satélite Iota-2  \cite{rs9010095}, sin embargo otro algoritmo basado en CART ha obtenido resultados interesantes y lo definiremos de manera formal a continuación:

A diferencia del modelo de Bosque Aleatorio, el algoritmo Aumento Extremo del Gradiente, variación de las /Gradient Boosting Machine/ en este algoritmo el impulso o /Boosting/ se usa de una manera diferente, se genera un conjunto usualmente pequeño de arboles de decisión y estos son mejorados iterativamente usando una función de perdida con regularización descrito matemáticamente así: \cite{chen2016xgboost} \\

Se un conjunto de datos de n ejemplos y m numero de predictores, un conjunto de CART se define como los k-esímos

#+NAME: eqn:cart_xg
\begin{equation}
\hat{y} = \phi(x_i) = \sum_{k=1}^{k} f_k(x_i) , f_k \in \mathcal{F}
\end{equation}
donde F es el espacio de arboles de regresión conocido también como CART. Aquí cada $f_k$ representa un CART distinto e independiente \cite{chen2016xgboost}.\\

Estos arboles son optimizados minimizando la siguiente función objetivo:

#+NAME: eqn:xg_optim
\begin{equation}
\mathcal{L}(\phi) = \sum_{i} l(\hat{y_i}, y_i) + \sum_{k} \Omega(f_k)
\end{equation}

donde :
#+NAME: eqn:xg_optim
\begin{equation}
\Omega(f) = \gammaT + \frac{1}{2} \lambda ||w||^2
\end{equation}

Donde l es la función de perdida convexa diferenciable entre la predicción $\hat{y_i}$ y el valor real $y_i$. El segundo termino $\Omega$ penaliza la complejidad del modelo[fn:14] \cite{chen2016xgboost}.



# Bagging

# Gradient Decent


**** Redes Neuronales Artificiales

Son una familia modelos de inteligencia artificial que intenta reproducir el comportamiento del cerebro, principalmente la relación entre la neuronas y sus conexiones. Estos modelos se constituyen por un grupo de elementos conocidos como neuronas que trabajan conjuntamente. Cada una de estas partes de la red recibe información y esta es enviada por medio de interconexiones hacia otras neuronas. En base a esta concepción es posible utilizar distintas configuraciones para realizar clasificaciones, regresiones, agrupaciones entre otros.\\

- Perceptron

  La forma mas simple y la base de las redes neuronales es el perceptrón, un modelo matemático que trata de reproducir el comportamiento individual de una neurona. Se define matemáticamente según la ecuación [[eqn:perceptron]].

#+NAME: eqn:perceptron
\begin{equation}
\label{eq:aqui-le-mostramos-como-hacerle-la-llave-grandPerceptrone}
f(x) =
sign \bigg[
\sum_{i=1}^{n} w_j \cdot x_{i \cdot j} + B
\bigg]
\end{equation}

Esta ecuación esta constituida por una composición de funciones, la primera es una función lineal constituida por un los pesos $w_j$ y el bias $B$ y por una función de activación $sign$ que aplica una transformación afín a la función anterior.


- Red Neuronal



#+NAME: eqn:nn
\begin{equation}
\label{eq: Pesos}
f(x) =
W_0 + k \cdot
\sum_{i=1}^{n} w_i \cdot x_{i}
\end{equation}

Donde $w_0$ es el vector de Bias, $w_i$ es el vector de pesos, $x_i$ la matriz de variables independientes y $k$ la transformación no lineal.

- Propagación hacia atrás

#+NAME: eqn:bp
\begin{equation}
\nabla w_{i j }(n) = \eta \cdot \delta \cdot J \cdot x_{ij} \cdot + \alpha \cdot \nabla w_{i j }(n - 1)
\end{equation}


**** Validación Cruzada
<<secvalcruz>>

La validación cruzada también conocida como /K-Fold Cross Validation[fn:9]/, es una técnica desarrollada para probar o testear la estabilidad y capacidad de los modelos entrenados sobre conjuntos con pocos datos, la idea general es dividir el conjunto completo de datos en paquetes más pequeños conocidos como /folds/, que a su vez se subdividen dos conjuntos uno para entrenamiento y otro para prueba, de manera que los algoritmos a evaluar serán entrenados de manera independiente en cada uno de los subconjuntos de entrenamiento y se testearan sobre los conjuntos de prueba.\\

#+CAPTION: Representación gráfica Validación cruzada
#+ATTR_LATEX: :width 5cm
#+LABEL: fig:CV
[[~/Dropbox/0_Tesis/imagenes/CV.png]]

*LLTO CV*

El *LLTO CV* o /Leave Location and Time Out - CV/ es un caso especial de la validación cruzada, propuesto inicialmente por \cite{Meyer} para enfrentar una apropiada validación en modelos espacio-temporales, teniendo en cuenta las propiedades de auto-correlación espacial y auto-correlación temporal, donde su combinación es conocida como


#+CAPTION: Validación cruzada en estaciones meteorológicas
#+ATTR_LATEX: :width 7cm
#+LABEL: fig:Estaciones
[[~/Dropbox/0_Tesis/imagenes/Estaciones.png]]

La idea detrás del uso de la estrategia de validación cruzada *LLTO* es dada la limitada cobertura espacial de las estaciones y la imposibilidad de tener datos independientes para la evaluación, es subdividir los datos de manera se incite a los modelos entrenados a generalizar y capturar la auto-correlación tanto espacial como temporal\cite{wikle2019spatio}.\\

Como ejemplo dadas las estaciones azul, roja y amarilla, para las fechas circulo, cuadrado y triangulo, definidas en la figura [[fig:Estaciones]] [fn:10] la estrategia *LLTO CV* divide los datos con los criterios espaciales y temporales mencionados, obteniendo el resultado visualizado en la Figura [[fig:KFoldLTSO]] [fn:10].\\


#+CAPTION: Estrategia de validación cruzada espacio-temporal
#+ATTR_LATEX: width=0.9\textwidth
#+LABEL: fig:KFoldLTSO
[[~/Dropbox/0_Tesis/imagenes/KFoldLTSO.png]]

* Marco de Referencia
<<secmr>>

La gestión de los riesgos de sequía tiene por objetivo mejorar la capacidad de la sociedad para hacer frente a eses fenómeno, donde la vigilancia y alerta temprana de la sequía son dos componentes importante de la gestión del riesgo de sequías \cite{wmo2006vigilancia}. \\

El monitoreo de la sequía utilizando índices espectrales puede contribuir a diversos procesos de toma de decisiones y al desarrollo de sistemas de alerta temprana de sequía \cite{PARK2016157}, impactando positivamente las zonas afectadas por este fenómeno. Por este motivo, diferentes autores han abordado esta temática desde perspectivas diferentes.\\

Como por definición la sequía es una disminución temporal y espacial de la precipitación pues lógicamente los estudios de sequía más clásicos se centran en este parámetro, valiendonse inicialmente de estaciones meteorológicas, pasado un tiempo se han integrado otro tipo de variables para el estudio de este fenómeno, que esta estrechamente relacionado con un cambio en la concepción de la sequía. \\

Un caso de este tipo de aproximación que se puede denominar clásica es la descrita por \cite{ceron2014sequias}, donde se evalúa la adaptabilidad que puede tener los agricultores de una cuenca en la región de Dagua, Colombia, por medio del estudio de las estaciones meteorológicas de la zona, evaluando la posición y continuidad temporal de los datos que proveen estas estaciones para realizar su análisis \cite{ceron2014sequias}.\\

Por su parte en \cite{CaracterizacionSequias} se hace un recuento de las diferentes técnicas tanto clásicas como contemporáneas para la evaluación de sequías, resaltando a su vez las técnicas basadas en el análisis estadístico mediante índices de series históricas de estaciones de campo, técnicas e índices sustentados en la teledetección, y la poderosa combinación que puede resultar de ambas \cite{CaracterizacionSequias}.\\

Sin embargo la complejidad de este fenómeno ha requerido de la combinación de diferentes variables para su caracterización, es el caso de \cite{xu2016research} donde se evaluó la cantidad y la distribución espacial de la precipitación, y a partir de esto se determinó los factores que influencian el fenómeno de la sequía \cite{xu2016research}. Entre los factores evaluados estan:\\

La precipitación, la temperatura, la altitud, la vegetación y la humedad del suelo. Aplicando por su parte /Precipitation Anomaly Percentage (Pa)/, y análisis de correlación \cite{xu2016research}. \\

Ahora bien otros autores como los que se describen a continuación utilizaron unas aproximaciones mas contemporáneas, entre las que resalta la implementación de técnicas de inteligencia artificial (I.A.) aplicadas al sensoramiento remoto en especial para mejorar la resolución espacial de conjuntos de datos que son muy precisos en cuanto a su resolución temporal, y de este modo hacer un control y monitoreó más efectivo.\\

Es el caso de  \cite{park2017drought}, centraron sus esfuerzos en la determinación de la humedad del suelo como indicador de la presencia o ausencia de la sequía, bajo el supuesto de que la humedad del suelo es un factor clave en el monitoreo de la sequía pues se relaciona con la precipitación, evapotranspitación y ek rendimiento de cultivos \cite{park2017drought}\\

Para esto se valieron de datos del sensor AMSR-E a bordo del satélite AQUA, además de productos de MODIS, como el MOD11A2, MOD16A2, MCD43B3, MCD15A2 MYD13A2, que constituyen temperatura superficial, evapotranspiración, albedo, índice de área foliar. NDVI, y EVI. Por otro lado, para la precipitación usaron datos de la misión TRMM, y datos /in situ/ para la validación del modelo de /downscaling/ o de desagregación utilizado. La zona de estudio fue la península de Corea. En particular en su flujo de trabajo resalta la implementación del modelo de /Machine Learning/ Bosque Aleatorio con el fin de realizar la reducción de la escala del las variables utilizadas y mejorar la resolución expacial de los datos sin perder al resolución temporal, el coeficiente de correlación R² ascendió a entre 0.93 y 0.95 con un RMSE asociado de entre 0.32 y 0.035.\\

Por otro lado \cite{rhee2017meteorological}, los autores prentende utilizar datos de teledetección y prediccción de un largo registro temporal para implementar un modelo de aprendizaje de maquina para las áreas no evaluadas anteriormente en su zona de estudio. Afirmando que un monitoreo de la sequía en tiempo real o casi real se constituye en una herramienta de gran valor para los sistemas de alerta temprana de sequía, y a partir de estos potenciar la toma de decisiones apropiadas que en ultima instancia disminuya los daños que ocasionan las sequías\cite{rhee2017meteorological}.\\

Por lo que es importante evaluar las metodologías para realizas los pronósticos de sequía que incluyen modelos de regresión, modelos de series de tiempo, redes neuronales artificiales, y modelos híbridos; estos métodos se aplican con el fin de determinar aspectos de los pronósticos como la estimación del inicio y fin del fenómeno, la severidad de este, su probabilidad de ocurrencia, entre otros.\\

Para esto \cite{rhee2017meteorological}, centra su estudio en el uso del SPI y el SPEI (índice estandarizado de precipitación y evapotranspiración), apuntando sus esfuerzos en determinar sequía meteorológica. Evaluando cuatro modelos de aprendizaje de máquina para identificar cuál obtiene los mejores resultados, estos tres son arboles de decisión (CART), Bosque Aleatorio (RF) y arboles extremadamente aleatorios, comparando los anteriores con una interpolación espacial tipo Kriging.\\

Entre los resultados destaca un mejor comportamiento de los modelos de aprendizaje de maquina tipo regresión sobre los modelos de clasificación, centrando sus resultados en analizar los primeros. Donde los arboles extremadamente aleatorios obtuvieron los resultados mas relevantes.\\

En un sentido similar se dirigió \cite{park2017drought}, este autor en base a productos de precipitación TRMM aplicaron tres enfoques de aprendizaje automático basados en arboles; Bosque Aleatorio (RF), Arboles de Regresión Potenciados, y Cubista; modelos que han demostrado ser robustos y flexibles para muchas aplicaciones de regresión, usando estos para evaluar la relación entre los factores de sequía y las condiciones de sequía.\\

Con base en esto se aplico el SPI, NDVI, y LST obteniendo que el NDVI era la variable mas importante en las regiones húmedas y el LST en las regiones áridas al momento de caracterizar la sequía\cite{PARK2016157}.\\


Otros estudios realizan un análisis de los comportamientos globales de la sequía, y las perspectivas a futuro del fenómeno, teniendo en cuenta las proyecciones climáticas sustentadas en el cambio climático \cite{schwalm2017global} . Sin embargo, también aplican el algoritmo de Random Forest en su estudio para determinar la importancia de los diferentes predictores; concluyendo que a raíz del cambio climático, es altamente probable que los tiempos de recuperación después de un evento de sequía sean insuficientes para los ecosistemas, aumentando la exposición y vulnerabilidad de estos mismos ante los fenómenos de sequía\cite{schwalm2017global}.\\



* Marco Metodológico
<<secmm>>
** Zona de Estudio

El departamento de La Guajira, es la zona continental mas septentrional de Colombia, limita al oriente con Venezuela, al sur con los departamentos del Cesar, y el Magdalena, al occidente y al norte con el Mar Caribe como se puede detallar en la figura [[fig:ZE_salina_grafica3]].\\

Geográficamente el departamento está constituido por la península de La Guajira, una planicie en su centro, y partes de la sierra Nevada de Santa Marta y de la Serranía del Perijá, extendiéndose en una superficie de 20 848 (km²). La presencia de estas formaciones montañosas, hace que en este departamento se encuentren todos los pisos termicos de la zona intertropical donde el ecosistema predominante son las zonas desérticas y semidesértica.\\

Por último en cuanto a recursos hídricos sus principales fuentes son el rio Ranchería y el rio Cesar, ademas del Jerez, Ancho y Palomino; ademas de arroyos, pozos acuíferos o jagüeyes  \cite{GLG}; sin embargo esta hidrografía presenta una muy baja regulación hídrica (es decir muchos causes son temporales) lo que limita la recuperación que puede llegar a tener tanto los ecosistemas como las personas a lo fenómenos de sequía\cite{GLG}\cite{garcia2014estudio}.



#+CAPTION: Zona de estudio del proyecto
#+ATTR_LATEX: :width 8cm
#+LABEL: fig:ZE_salina_grafica3
[[~/Dropbox/0_Tesis/imagenes/ZE_salida_grafica3.png]]

** Conjunto de Datos

El conjunto de datos utilizado para realizar el presente proyecto, se describe a continuación.\\

Variables derivadas de datos /in situ/:

- Precipitación.

Variables derivadas del sensor MODIS y su resolución espacial:

- Temperatura Superficial (LST) (1000 m) \cite{Dewan1999modis}.
- Índice de Vegetación Normalizado (NDVI) (250 m) \cite{huete1999modis}.
- Índice de Vegetación Mejorado (EVI) (250 m) \cite{huete1999modis} .
- Índice de Área Foliar (LAI) (500 m) \cite{knyazikhin1999modis}.
- Evapotranspiración  (ET) (500 m ).

Variables derivadas del productos CHIRPS (/Group InfraRed Precipitaction with statio data/):
- Precipitación. (5000 m)[fn:11].



** Métodos

Como se puede ver en la figura [[fig:flujograma]] donde se puede observar el flujo de trabajo diseñado.


#+CAPTION: Flujograma General del Proyecto
#+ATTR_LATEX: :width 13cm
#+LABEL: fig:flujograma
[[~/Dropbox/0_Tesis/imagenes/flujograma2.png]]

#+LATEX: \newpage
*** Pre-procesamiento de datos /in situ/

*Selección de estaciones*\\

En la zona de estudio encontramos 160 estaciones meteorológicas o hidrológicas con mediciones de precipitación diaria. A paso seguido se aplico un doble filtro de calidad sobre la información, el primero fue la selección de aquellas estaciones con registros faltantes o nulos no mayores al 10% de todos los registros, y el segundo una continuidad de los registros no menos a 32 años, entre 1980 y 2012.

Dado que el SPI requiere que la entrada de datos tenga el registro completo de la serie de tiempo, se procedió a imputar los valores faltantes.

*Imputación de datos faltantes*

A continuación se estudiaron distintos métodos de imputación de datos, se seleccionaron los siguientes:

- /Last observation carried fodward/
- Suavizado de Kalman
- /Seasonally Decomposed Missing Value Imputation/
- /Seasonally Splitted Missing Value Imputation/

De los anteriores se seleccionó el método de /Seasonally Decomposed Missing Value Imputation/, pues obtuvo los errores de imputación mas bajos sobre una muestra de 10 estaciones con alrededor del 10% de datos faltantes.\\

De manera practica se utilizo la librería de R /ImputeTS/ para realizar este procesamiento.\\

Una vez obtenidas las series completas, se procedió a acumular los datos de precipitación a escala mensual.\\

*Cálculo SPI no paramétrico*

Seguidamente se realizo la estimación del *SPI no paramétrico* para las ventanas temporales de 3, 6 y 9 meses. Para esto se utilizo una biblioteca originalmente diseñada para /MATLAB/ llamada /Standarized Drought Analysis Toolbox (SDAT)/.\\

Se implementaron unas pequeñas modificaciones sobre la biblioteca, la primera es que se ejecuto sobre un ambiente de software libre llamado /Octave/ para asegurar que se cumplieran los postulados de la ciencia reproducible [fn:12]. Y el segundo que se realizo una mínima modificación sobre el código fuente para que la biblioteca calculara el *SPI no paramétrico* sobre todas las estaciones del estudio.\\

*** Pre-procesamiento de datos raster

En esta sección de la metodología se constituye de todos los pasos necesarios para transformar los datos descargados de los servidores de las agencias espaciales y de las Unidades de Investigación de distintas universidades del mundo, transformándolos para ser consumidos por los modelos seleccionados para realizar la fusión.\\

	#+CAPTION:Flujograma de preprocesamiento raster
#+ATTR_LATEX: :width 7cm
#+LABEL: fig:flujograma_raster
[[~/Dropbox/0_Tesis/imagenes/image13.png]]

*Descarga de Productos*

El primer paso consiste en la descarga automática de los productos raster utilizados, para esta descarga se utilizaron dos estrategias, según el proveedor de datos.\\

El primer proveedor es la /Universidad de California Santa Bárbara/, en la página web de su /Centro de Riesgos Climáticos/. Que mediante el uso de la herramienta de línea de comandos /WGET/ se creo una pequeña rutina que pudiese descargar los datos diarios de precipitación para el periodo de tiempo de .\\

En segundo lugar y por medio de la utilidad de línea de comandos de la librería de /Python PyModis/ se ejecuto la descarga de los productos derivados del sensor MODIS.\\

*Proyección de datos*

El siguiente paso de la metodología consiste en la asignación de una proyección cartográfica a los datos MODIS, pues el formato nativo de esta es *.hdf carece de dicho sistema de referencia. Así que se procedió a utilizar el módulo /modis_mosaic.py/ para construir el mosaico virtual de cada uno de los productos creándose un archivo en formato *.vrt. A continuación se realiza la conversión la información a formato *.TIF haciendo uso del módulo /modis_convert.py/.


*Recorte*

Luego se realiza el recorte de la información raster a la zona de estudio, dibujada a mano alzada, de manera que incluye la totalidad del Departamento de La Guajira, para este procesamiento se utilizó el modulo /gdal_warp/ de la librería GDAL (Librería de Abstracción de Datos Geográficos). La figura muestra el resultado del recorte de las imágenes a la zona de estudio.

#+CAPTION: Recorte a la zona de estudio
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:cut_line
[[~/Dropbox/0_Tesis/imagenes/image18.png]]


*Ingestión en GRASS GIS*

A paso seguido se realizó la ingestión de la información en el software GRASS GIS, de manera que se aprovechará todas las potencialidades de este software que incluyen pero no se limitan al soporte de un marco para series de tiempo de datos raster y vectoriales, manejo eficiente de la memoria RAM, orden en el conjunto de datos y finalmente un almacenamiento eficiente en disco duro.\\

Además se escalan los valores de los productos, para que estos queden almacenados en sus valores reales físicos, para esto se usa la información interna de los productos para enmascarar los pixeles no validos.\\

*Aplicación Máscara de agua*

Dado que la zona de estudio se encuentra a orillas del Mar Caribe, es necesario tener en cuenta que la zona de modelación está limitada por el contorno de la superficie de agua, por lo tanto se utiliza el producto de máscara de agua de MODIS, para invalidar los valores pertenecientes a las superficies de agua.\\

*Homogenenización de la serie raster*

Acto seguido y teniendo en cuenta que los diferentes productos tienen resoluciones temporales diferentes es necesario homogeneizar las series, dado que el indicador objetivo el *SPI no paramétrico* se estima a escala mensual, es necesario agrupar la información de los productos a esta escala.\\

Tenemos tres casos según el producto. Por un lado están el producto de precipitación y por el otro tenemos los productos MODIS que se distribuyen en dos resoluciones temporales, los productos de 8 días y los de 16 días.\\

- CHIRPS: Para la precipitación los datos de CHRIPS pueden ser descargados a distintas escalas, en particular para este estudio se descargo el producto diario de precipitación y este se acumulo a escala mensual.\\

- MODIS 8 días : Estos productos que incluyen ET, LAI, LST. Estos se promediaron a escala mensual.\\

- MODIS 16 días : El producto distribuido con esta resolución temporal es el MOD13, el producto de Índices de Vegetación, del que se obtiene el NDVI, el EVI y las bandas infrarroja cercana e infrarroja media. A estas series se imputo sobre la serie el valor promedio en el tiempo, para obtener una serie de 8 días, posteriormente se promediaron los valores para obtener la serie mensual.  \\


#+LATEX: \newpage
*Cálculo NDWI y NDDI*

Adicional a lo anterior, se generaron dos variables explicativas adicionales de los productos descargados, estos se describen a continuación. \\

#+CAPTION: Cálculo NDDI
#+ATTR_LATEX: :width 5cm
#+LABEL: fig:calculo_NDDI
[[~/Dropbox/0_Tesis/imagenes/calclulo_NDDI.png]]

Se extraen las bandas de infrarrojo cercano e infrarrojo medio del producto MOD13 y se aplica la ecuación [[eqn:ndwi]].\\

A continuación se procede a calcular el NDDI, para esto se utilizan los productos de NDVI y NDWI recientemente calculado según la ecuación [[eqn:nddi]].\\

*Relleno de datos faltantes*

Dada la persistente nubosidad de la zona de estudio, y a pesar del uso de ventanas temporales de 8 días para minimizar este efecto, aún se pueden encontrar amplías zonas con píxeles no válidos, debido en particular a la presencia de nubes.\\

Se aplico un método de relleno de datos faltantes para series de tiempo raster homogéneos en sus resoluciones espaciales y temporales, basado en una modificación del análisis de componentes principales e implementado mediante el software R, en particular el paquete o librería /sinkr/ donde se encuentra implementado el algoritmo /DINEOF/ para su formalización teórica ver la <<secidf>>.\\

Una vez surtido lo anterior se da por finalizado el pre-procesamiento raster.\\

*** Procesamiento

Una vez los datos de las fuentes raster e /in situ/ están homogenizadas a una muestreo temporal común, y dadas las diferencias en la ventana temporal de disponibilidad de datos para ambas fuentes de datos se selecciona la intersección de ambas para generar un conjunto el conjunto de datos de entrenamiento.\\

Esto es tomar los datos /in situ/ con una ventana temporal entre 1982 - 2014, los datos raster con una ventana temporal de 2000 - 2012, de modo que el periodo de predicción comprende entre 2000 y 2012.\\

Una vez se completa lo anterior, se realiza la extracción de valores de las diferentes variables explicativas en la localización de las estaciones. Y se construye lo que se conoce como una *Matriz de entrenamiento*; matriz que sera usada para ajustar los algoritmos seleccionados.\\

*** Entrenamiento y ajuste de hiperparamétros
<<sectrn>>

Una vez constituida la matriz de entrenamiento se procede a realizar la selección de hiper-parámetros para ajustar los algoritmos seleccionados, estos son:

**** Random Forest
- Numero de estimadores : 100
- Criterio : error medio cuadrático
- numero mínimo de muestras a dividir : 2
- numero mínimo de muestras por hoja : 1
- mínimo de decrecimiento de la impureza : 0.0

**** XGBoosts
- Numero de estimadores : 10
- objective : error medio cuadrático
- numero de columnas de muestra por árbol : 0.3
- tasa de aprendizaje : 0.1
- profundidad máxima : 5
- alfa: 10
**** MLP
- Arquitectura :
  + Numero de entradas: 8
  + Capas ocultas : 1
  + Numero de neuronas en la capa oculta : 11
  + Capa de salida : 1
- Función de Activación : ReLu y linear
- Dropout: 0.05
- tamaño del batch : 25
- numero de épocas : 1000
- tasa de aprendizaje : 0.0001


*** Validación Cruzada
Una vez ajustados los modelos estos deben de ser evaluados, la estrategia utilizada fue la de *validación cruzada espacio-temporal (LLTO)*. \\

Esta estrategía introducida en [[secvalcruz]] tiene como objeto evaluar la robustez de los métodos aplicados, para ello se aplico una validación cruzada con 20 subconjuntos de datos, divididos a su vez en 70% para entrenamiento y 30% para validación. A cada uno de estos subconjuntos se ajusto los modelos seleccionados de manera independiente, y se evaluaron las métricas de Error Medio Absoluto (MAE) y Error Medio Cuadrático (MSE).\\

La implementación de esta sección se realizo haciendo uso de la librería CAST implementada en R, adicionalmente se aplico una interfaz con Python a través de R2py2.\\


*** Importancia de las Variables

Finalmente los modelos basados en arboles, en particular el Random Forest permite evaluar la importancia de las variables predictoras sobre la estimación final, se realizara la extracción de esta información para mejorar la interpretabilidad de los modelos.\\

* Resultados
<<secresult>>

A continuación se expondrán los resultados parciales y finales de la metodología expuesta en la sección [[secmm]].

** Pre-procesamiento de datos /in situ/

Primeramente se revisara la salida de el preprocesamiento de los datos /in situ/, de las 162 estaciones de la zona de estudio seleccionada, solo 51 estaciones pasaron los dos filtros, el primero de una suficiente longitud de los registros, y de una incompletitud de los registros menor al 10%.\\

A partir de estas 51 estaciones se aplico el método de imputación de datos /Seasonally Decomposed Missing Value Imputation/. En la figura [[fig:distribucion_NA_tiempo]] se puede visualizar un ejemplo de imputación de datos sobre una estación de muestra, con los valores imputados en rojo.\\

#+CAPTION: Imputación de datos faltantes en una estación de muestra
#+ATTR_LATEX: width=0.9\textwidth
#+LABEL: fig:distribucion_NA_tiempo
[[~/Dropbox/0_Tesis/imagenes/distribucion_imputado_tiempo.png]]


*Gráfico de una Estación de muestra*

Seguidamente se acumula la precipitación en ventanas temporales de un mes y se estima el SPI no paramétrico, podemos visualizar un ejemplo de lo anterior en la [[fig:perfil_temporal_XG_trn_completa]], y [[fig:perfil_temporal_XG_trn_completa]].\\

#+CAPTION: Comportamiento del SPI en una estación de muestra entre el año 2000 y el año 2014.\\
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa1
[[~/Dropbox/0_Tesis/imagenes/SPI_1734_.png]]


#+CAPTION: Comportamiento del SPI en una estación de muestra entre el año 2000 y el año 2014.\\
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1738_.png]]


# ** TODO Mensionar la climatología de la zona

** Pre-procesamiento de datos raster

A continuación se presentaran unos gráficos resumen de la fase de pre-procesamiento de los datos raster, estos gráficos corresponden a los valores promedios mensuales a lo largo del periodo de observación de los datos raster, comprendido entre el año 2000 y 2014.\\

Y en general podemos visualizar en las variables de estudio el impacto de la composición oreo-gráfica del terreno, con una zona nororiental plana y  con condiciones semi-deserticas, una zona sur occidental montañosa conformada por la sierra nevada de Santa Marta y la serranía del perijá al sur-oriente; y finalmente las zonas de transición y la zona transición con alturas moderadas.\\

*** Precipitacion


#+CAPTION: Comportamiento promedio mensual de la precipitación
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_Prec
[[~/Dropbox/0_Tesis/imagenes/level_plot_Prec.pdf]]

Primeramente tenemos la precipitación, esta variable dada su resolución mas baja presenta un comportamiento mas suave entre las regiones descritas anteriormente, sin embargo es posible diferenciarlas marcadas por sus diferencias en las precipitaciones,  con unas precipitaciones mas altas sobre la zona de la sierra nevada de santa marta, seguida por una zona de transición y finalmente una zona semi desértica al norte con unas precipitaciones cercanas a cero a lo largo del periodo de datos de MODIS disponibles.\\



#+CAPTION: Gráfico de densidad promedio mensual de la precipitación
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_Prec
[[~/Dropbox/0_Tesis/imagenes/densityplot_Prec.pdf]]

En el comportamiento en frecuencia se ve claramente la concentración de los valores de precipitaciones nulas y concentradas a inicio del año.\\

#+CAPTION: Gráfico de caja-violín promedio mensual de la precipitación
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_Prec
[[~/Dropbox/0_Tesis/imagenes/bwplot_Prec.pdf]]

Que se complementa con el gráfico de caja y bigotes donde se observa un comportamiento unimodal en la distribución de la precipitación a lo largo del año, en el promedio de la ventana temporal del año 2000 al 2014.
# Con unos niveles de precipitación en promedio por debajo de los 400 mm por mes al año.\\

#+LATEX: \newpage

*** Evapotranspiración

Seguidamente la evapotranspiración tiene un comportamiento bastante homogeno en el espacio, con valores de evapotranspiración ahí donde se espera que haya presencia de vegetación y valores bajos donde esta es escasa.


#+CAPTION: Comportamiento promedio mensual de la evapotranspitación
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_et
[[~/Dropbox/0_Tesis/imagenes/level_plot_et.pdf]]

Esto se corrobora en el gráfico de densidad donde el rango de valores es constante a lo largo del año y una alta variabilidad en sus valores inter-mensuales.\\

#+CAPTION: Gráfico de densidad promedio mensual de la evapotranspitación
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_et
[[~/Dropbox/0_Tesis/imagenes/densityplot_et.pdf]]

Sin embargo podemos ver como los valores de evapotranspiración son mas bajo a inicio del año, en especial en febrero, marzo y abril, siendo mas constante el resto del año, esto es esperable dada la disponibilidad de agua a lo largo del año, vista en el régimen de precipitaciones.\\

#+CAPTION: Gráfico de caja-violín promedio mensual de la evapotranspitación
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_et
[[~/Dropbox/0_Tesis/imagenes/bwplot_et.pdf]]


#+LATEX: \newpage

*** Temperatura Superficial

Por su parte, la temperatura superficial representa un comportamiento relativamente homogéneo a lo largo del año, marcándose diferencia por oreo-grafía. Es de resaltar las altas temperaturas promedio a las que se ve expuesta esta zona de estudio.\\

#+CAPTION: Comportamiento promedio mensual de la temperatura Superficial
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_LST
[[~/Dropbox/0_Tesis/imagenes/level_plot_LST.pdf]]

Es posible visualizar en el gráfico de densidad como los valores extremos de temperatura se concentran en la época del año con valores de precipitación mas altos, y siendo cierto también lo contrario.\\

#+CAPTION: Gráfico de densidad promedio mensual de la temperatura Superficial
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_LST
[[~/Dropbox/0_Tesis/imagenes/densityplot_LST.pdf]]

En el gráfico de cajas y bigotes se observa como la temperatura mantiene valores muy altos a lo largo del año y estos bajan menos de unos pocos grados a final de año, época en la que se concentran las lluvias.\\

#+CAPTION: Gráfico de caja-violín promedio mensual de la temperatura Superficial
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_LST
[[~/Dropbox/0_Tesis/imagenes/bwplot_LST.pdf]]


#+LATEX: \newpage


*** NDWI

El comportamiento de la humedad estimada por el NDWI es mas alta en las zonas montañosas y de transición, a excepción de las picos mas altos dentro de la sierra nevada, por el contrario los valores bajos de las zona semi-desértica, esta en particular aumenta sus valores, y por tanto su humedad hacia el final del año.\\


#+CAPTION: Comportamiento promedio mensual del NDWI
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_ndwi
[[~/Dropbox/0_Tesis/imagenes/level_plot_ndwi_v2_.pdf]]

En el gráfico de densidad podemos visualizar como los meses húmedos concentran los valores mas altos del indicador y una ligera disminución al inicio del año en la temporada seca.\\

#+CAPTION: Gráfico de densidad promedio mensual del NDWI
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_ndwi
[[~/Dropbox/0_Tesis/imagenes/densityplot_ndwi.pdf]]

Esto se corrobora en el gráfico de cajas y bigotes. Donde se visualiza claramente valores bajos a inicio de año en los meses de febrero, marzo,  abril.\\

#+CAPTION: Gráfico de caja-violín promedio mensual del NDWI
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_ndwi
[[~/Dropbox/0_Tesis/imagenes/bwplot_ndwi.pdf]]



#+LATEX: \newpage

*** NDVI

El comportamiento del NDVI nos permite realizar una estimación visual de la distribución de la vegetación. Donde podemos ver como la vegetación se concentra en la zona montañosa, a excepción de los grandes picos del centro de la sierra nevada. \\

#+CAPTION: Comportamiento promedio mensual del NDVI
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_ndvi
[[~/Dropbox/0_Tesis/imagenes/level_plot_ndvi_v2_.pdf]]

En cuanto a su comportamiento en el gráfico de densidad podemos ver la concentración de los valores altos del NDVI a final del año, y con valores un poco más bajos concentrados en los meses iniciales del año.\\

#+CAPTION: Gráfico de densidad promedio mensual del NDVI
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_ndvi
[[~/Dropbox/0_Tesis/imagenes/densityplot_ndvi.pdf]]

Distribución que se corrobora con el gráfico de cajas y bigotes.\\

#+CAPTION: Gráfico de caja-violín promedio mensual del NDVI
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_ndvi
[[~/Dropbox/0_Tesis/imagenes/bwplot_ndvi.pdf]]


#+LATEX: \newpage

*** EVI

Lo valores del EVI o índice de vegetación mejorada es muy similar al del NDVI, pero dada la corrección atmosférica explicada anteriormente los distribución de los valores es menor. \\


#+CAPTION: Comportamiento promedio mensual del EVI
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_evi
[[~/Dropbox/0_Tesis/imagenes/level_plot_evi_v2_.pdf]]

En cuanto al comportamiento en densidad se ve claramente la distribución de los valores, y una distinción mas marcada a lo largo del año con los valores bajo concentrados en el inicio del año y los valores altos al final, en coincidencia con los patrones de precipitación.\\

#+CAPTION: Gráfico de densidad promedio mensual del EVI
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_evi
[[~/Dropbox/0_Tesis/imagenes/densityplot_evi.pdf]]

Patrón que se repite en el gráfico de caja y bigotes.

#+CAPTION: Gráfico de caja-violín promedio mensual del EVI
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_evi
[[~/Dropbox/0_Tesis/imagenes/bwplot_evi.pdf]]


#+LATEX: \newpage


*** LAI

Por su parte la variable *LAI* o índice de área foliar, es posible identificar muy claramente las zonas ore-gráficas de la zona de estudio. En particular unos valores bajos del índice en la zona seca y en las partes más altas de la zona montañosa y con valores mucho mas altos en la estribaciones de la sierra nevada de Santa Marta.\\


#+CAPTION: Comportamiento promedio mensual del LAI
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_lai
[[~/Dropbox/0_Tesis/imagenes/level_plot_lai.pdf]]

En el gráfico de densidad podemos ver como los valores bajos se concentran al inicio del año y los valores altos en la parte final del año.\\

#+CAPTION: Gráfico de densidad promedio mensual del LAI
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_lai
[[~/Dropbox/0_Tesis/imagenes/densityplot_lai.pdf]]

Esta distribución se repite en el gráfico de caja-violín.\\

#+CAPTION: Gráfico de caja-violín promedio mensual del LAI
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_lai
[[~/Dropbox/0_Tesis/imagenes/bwplot_lai.pdf]]


#+LATEX: \newpage


*** NDDI

Finalmente para el índice de sequía normalizado (NDDI) de nuevo tenemos una clara distinción entre las zonas orográficas con valores altos del índice en las zonas montañosa húmeda. Esto nos dice que la sequía impacta más severamente las zonas donde la humedad es más alta.

#+CAPTION: Comportamiento promedio mensual del NDDI
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_nddi
[[~/Dropbox/0_Tesis/imagenes/level_plot_nddi.pdf]]

En el gráfico de frecuencia se comporta similar a los indicadores estudiados, donde al inicio de año se concentran los valores bajos y al final del año se concentran los valores altos.\\

#+CAPTION: Gráfico de densidad promedio mensual del NDDI
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_nddi
[[~/Dropbox/0_Tesis/imagenes/densityplot_nddi.pdf]]

Situación que se repite en el gráfico de caja-violín.\\

#+CAPTION: Gráfico de caja-violín promedio mensual del NDDI
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_lai
[[~/Dropbox/0_Tesis/imagenes/bwplot_nddi.pdf]]


#+LATEX: \newpage

** SPI no paramétrico estimado
*** Ajuste de los Valores
**** Redes Neuronales

El primero modelo evaluado gráficamente es el de las redes neuronales tipo MLP con la configuración especificada en la sección [[sectrn]].
Un gráfico de dispersión para una estación de muestra es mostrada en la figura [[fig:ANNP.png]].\\

#+CAPTION: Correlacion entre los valores reales y predichos Red Neuronal 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:ANNP.png
[[/home/juanse/Dropbox/0_Tesis/imagenes/ANNP.png]]

Dada la imposibilidad de la red neuronal tipo Perceptrón Multi-capa implementado de converger, este modelo es descartado de los análisis posteriores.\\

#+LATEX: \afterpage{\FloatBarrier}
**** Bosque Aleatorio (RF)

Para el siguiente modelo, tomamos la información de las 51 estaciones, se realizo un grafico de dispersión y se ajusto una regresión lineal, para cada una de las ventanas temporales seleccionadas de 3, 6 y 9 meses.\\

Es posible detallar a través de los tres gráficos como la dispersión de los datos mejora para ventanas temporales mayores, lo que implica que el modelo tiene mas problemas para capturar el comportamiento en periodos cortos de tiempo.\\

#+CAPTION: Correlacion entre los valores reales y predichos Random Forest 3 meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_rf_3_meses.png]]

#+CAPTION: Correlacion entre los valores reales y predichos Random Forest 6 meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_rf_6_meses.png]]


#+CAPTION: Correlacion entre los valores reales y predichos Random Forest 9 meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_rf_9_meses.png]]

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}

**** Aumento Extremo del Gradiente (XG)

De forma similar para el siguiente modelo se el XGBoost se realizo un gráfico de dispersión para todas las ventanas temporales.
En este podemos visualizar como de manera similar al modelo Random Forest, la dispersión de la predicción aumenta conforme la ventana temporal aumenta.
Esto sumado a el hecho de tener unas correlaciones mas altas que el modelo random forest.\\

#+CAPTION: Correlacion entre los valores reales y predichos XGBoost
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_xg_3_meses.png]]

#+CAPTION: Correlacion entre los valores reales y predichos XGBoost
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_xg_6_meses.png]]


#+CAPTION: Correlacion entre los valores reales y predichos XGBoost
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:correlacion_RF_trn_completa
[[~/Dropbox/0_Tesis/imagenes/prediccion_xg_9_meses.png]]
#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}


*** Métricas de Error

Una vez mas en detalle podemos visualizar el comportamiento de las métricas de error del entrenamiento de los modelos, en particular sobre los datos no vistos por el modelo, o los datos de validación.

Como se menciono antes, la estrategia escogida fue la de validación cruzada usando el criterio espacio-temporal LLTO, el resultado de dicha estrategia puede ser visualizado en la figura [[fig:all_metrics]] donde tenemos lo siguiente. La columna izquierda representa las rondas del modelo random forest durante el entrenamiento, a su vez la columna derecha representa las rondas del modelo XGBoost. Por otro lado las filas representan las ventanas temporales de los modelo entrenados, 3, 6 y 9 meses para la primera, segunda y tercera fila. Las 20 barras de cada gráfico representan individualmente las rondas de entrenamiento computadas, y el color de la barra representa la métrica monitoreada, azul para error medio absoluta (MAE) y naranja para el error medio cuadrático (MSE).\\

Se puede visualizar un comportamiento bastante homogeno en la distribución de los errores para los modelos, con resultados ligeramente superiores para el modelo XGBoosts.Adicionalmente en los cuadros [[tab:mae]] y [[tab:mse]] tenemos los valores promedio de las métricas para cada ventana temporal.\\




#+CAPTION: Métricas de Error Validación Cruzada el eje x representa 20 subconjuntos de datos y el eje y representa los errores en cada ronda de entrenamiento
#+ATTR_LATEX: :width 10.5cm :options angle=90
#+LABEL: fig:all_metrics
[[/home/juanse/Dropbox/0_Tesis/imagenes/MetricasValidacionCruzada.png]]

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}


#+tblname: tab:mae
#+CAPTION: Tabla de errores MAE promedio.\\
#+ATTR_LATEX: :align |l|l|l|
|------------------+--------+--------|
| Ventana Temporal | RF MAE | XG MAE |
|------------------+--------+--------|
| 3 meses          |  0.736 |  0.785 |
| 6 meses          |  0.783 |  0.863 |
| 9 meses          |  0.814 |  0.875 |
|------------------+--------+--------|



#+tblname: tab:mse
#+CAPTION: Tabla de errores MSE promedio\\
#+ATTR_LATEX: :align |l|l|l|
|------------------+--------+--------|
| Ventana Temporal | RF MSE | XG MSE |
|------------------+--------+--------|
| 3 meses          |  0.856 |  0.883 |
| 6 meses          |  0.883 |  0.927 |
| 9 meses          |  0.901 |  0.934 |
|------------------+--------+--------|
# +LATEX: \newpage
# +LATEX: \afterpage{\FloatBarrier}



*** Comportamiento Temporal

Por otro lado, tenemos visualizar el ajuste de los modelos al comportamiento temporal de una estación de muestra, es esta sección selecionamos una estación aleatoria y comparamos el comportamiento real del indicador SPI y los valores predichos por el modelo.\\

**** Random Forest

Para el modelo Random Forests tenemos podemos visualizar el comportamiento en las figuras [[fig:perfil_temporal_RF_trn_completa3]] [[fig:perfil_temporal_RF_trn_completa6]] [[fig:perfil_temporal_RF_trn_completa9]] en estos gráficos tenemos en negro el valor de SPI estimado y en verde la predicción del modelo. El ajuste temporal de los modelos es sigue el comportamiento general del fenómeno, con dificultades para la los valores mas altos y mas bajos del indicador. Parece existir una tendencia hacia los valores altos del indicador que indican condiciones humedas, mas que las condiciones secas .Además al incrementarse la ventana temporal el comportamiento tiene una tendencia mas clara y menos aleatorio por lo que el modelo puede describir más fidedignamente el comportamiento.\\

#+CAPTION: Perfil temporal entre los valores reales y predichos Random Forest 3 Meses (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_RF_trn_completa3
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_RF_trn_completa_3m.png]]


#+CAPTION: Perfil temporal entre los valores reales y predichos Random Forest 6 Meses (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_RF_trn_completa6
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_RF_trn_completa_6m.png]]


#+CAPTION: Perfil temporal entre los valores reales y predichos Random Forest 9 Meses  (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_RF_trn_completa9
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_RF_trn_completa_9m.png]]

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}
**** XGBoosts

De manera similar el modelo XGBoost que lo podemos visualizar el las figuras [[fig:perfil_temporal_XG_trn_completa3]] [[fig:perfil_temporal_XG_trn_completa6]] [[fig:perfil_temporal_XG_trn_completa9]] aquí se puede observar lo siguiente. El modelo reproduce el comportamiento temporal de una manera mas cercana en comparación con el modelo Random Forests con menos problemas para estimar los valores extremos aunque se observa cierto desplazamiento temporal en la curva descrita. Se observa igualmente una tendencia hacia valores de SPI positivos. Finalmente parece existir un menor impacto en el tamaño de la ventana temporal de estudio sobre la capacidad predictiva del modelo.\\



#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa3
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_XG_trn_completa_3m.png]]


#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 6 Meses (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa6
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_XG_trn_completa_6m.png]]


#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 9 Meses (En negro el SPI en verde la estimación del modelo)
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa9
[[~/Dropbox/0_Tesis/imagenes/perfil_temporal_XG_trn_completa_9m.png]]
#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}

*** Comportamiento Espacial

Para visualizar el comportamiento espacial, se selecciono el uso de la ventana temporal de 3 meses, y computar los valores promedios del indicador a nivel mensual, con el objetivo de tratar de visualizar tendencias regidas por el régimen de lluvias anual de la zona de estudio.\\

**** Random Forests

Para el modelo de Random Forest tenemos un comportamiento muy homogéneo a lo largo del tiempo, y con valores normales del índice, y con una zona en sequía alrededor de la ciénaga grande de Santa Marta. Es posible que sea un efecto de borde.\\


#+CAPTION: Comportamiento promedio mensual de la predicción SPI por RF
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_SPI_RF2
[[~/Dropbox/0_Tesis/imagenes/level_plot_SPI_RF_v2_.pdf]]

Para los valores en densidad podemos ver una diferencia más pronunciada en la distribución de los valores a lo largo del año, con el periodo seco concentrado en los meses de enero, febrero, una periodo de transición en diciembre y mayo; y condiciones húmedas al final de año.\\

#+CAPTION: Gráfico de densidad promedio mensual de la predicción SPI por RF
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_SPI_RF2
[[~/Dropbox/0_Tesis/imagenes/densityplot_SPI_RF2.pdf]]

Finalmente, en el gráfico de cajas-bigotes vemos que el algoritmo tiene dificultades que para capturar la variabilidad de los datos, lo que es consistente con lo visto, en los resultados anteriores.\\

#+CAPTION: Gráfico de caja-violín promedio mensual de la prediccion SPI por RF
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_SPI_RF2
[[~/Dropbox/0_Tesis/imagenes/bwplot_SPI_RF2.pdf]]

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}

**** XGBoosts

Por su parte el algoritmo de XGBoost tenemos una demarcación más precisa de las zonas semi-áridas en los valores del indicador. Donde además vemos como los valores bajos del indicador se concentran al inicio del año en los meses de enero, febrero y marzo, con un mes de transición en diciembre. Y los valores altos del indicador se concentran en las zonas de transición de la zona montañosa.\\

#+CAPTION: Comportamiento promedio mensual de la predicción SPI por XG
#+ATTR_LATEX: :width 12cm
#+LABEL: fig:level_plot_SPI_XG
[[~/Dropbox/0_Tesis/imagenes/level_plot_SPI_XG_v2_.pdf]]

Este comportamiento se replica en lo valores en densidad, con los valores húmedos altamente concentrados al final del año, a excepción de diciembre.\\

#+CAPTION: Gráfico de densidad promedio mensual de la predicción SPI por XG
#+ATTR_LATEX: :width 15cm
#+LABEL: fig:densityplot_SPI_XG
[[~/Dropbox/0_Tesis/imagenes/densityplot_SPI_XG.pdf]]

Esto finalmente se corrobora en el gráfico de cajas y bigotes.\\

#+CAPTION: Gráfico de caja-violín promedio mensual de la prediccion SPI por XG
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:bwplot_SPI_XG
[[~/Dropbox/0_Tesis/imagenes/bwplot_SPI_XG.pdf]]

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}


*** Importancia de los predictores

Por ultimo, una aspecto positivo de los modelos basados en arboles es la posibilidad de pesar la importancia de las variables predictoras sobre la predicción final, a continuación podemos visualizar la importancia de las variables según el modelo Random Forest.\\

#+CAPTION: Importancia de las variables predictoras Random Forest 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:importanciaRF
[[~/Dropbox/0_Tesis/imagenes/importanciaRF.png]]

Es posible visualizar en este gráfico que la importancia de las variables en los modelos aunque cambia sus valores relativos su orden se conserva a través de las distintas ventanas temporales del estudio. con Un primer grupo de variables como la precipitación y la temperatura superficial relacionadas con la climatología de la zona y seguida de el NDDI que sería una especie de conglomerado entre las variables relacionadas con la vegetación y la humedad. A continuación las variables cercanas o directamente relacionadas con el comportamiento de la vegetación y finalmente la humedad detectada por el satélite a través del NDWI.\\

La importancia de la precipitación, la temperatura superficial eran esperados, es relevante detectar la importancia del NDDI lo que puede inducirnos a interpretar que el uso de las variables vegetativas y del NDWI es muy redundante. Finalmente es posible que dada la climatología seca de la zona se obtengan unos pesos tan bajos de NDWI en la predicción. \\

#+LATEX: \newpage
#+LATEX: \afterpage{\FloatBarrier}


* Discusión
<<secdisc>>

Distintos autores han investigado el modelamiento y monitoreo de sequías, cada uno proponiendo distintas metodologías que aún no convergen a un único tratamiento del problema, hoy en día varias investigaciones se centran en el uso de técnicas de /machine learning/, como en el presente trabajo, donde se propende por fusionar datos de diferentes sensores, para aprovechar al máximo las virtudes de cada fuente.\\

Por ejemplo en Colombia, el organismo encargado de monitorear el estado de los recursos hídricos a nivel nacional es el Instituto de Hidrología, Meteorología y Estudios Ambientales (IDEAM). Que al igual que lo aquí expuesto realiza un monitoreo mensual del indicador de sequía meteorológica SPI, sin embargo su monitoreo es realizado en ventanas temporales de 1 y 12 meses. Además los métodos usados en su estimación difieren puesto que el IDEAM basa su metodología en un monitoreo clásico desde el punto de vista meramente hidrológico, por lo que sus fuentes de datos se limitan a las estaciones meteorológicas, realizando un exhaustivo análisis hidrológico que incluye estimación de periodos de retorno, análisis tendenciales, entre otros. Finalmente el estudio del IDEAM espacializa el comportamiento de la sequía usando interpolaciones basadas en métodos geoestadísticos, en contraposición a los modelos impulsados por datos expuestos en este trabajo. Dicho lo anterior, no es claro cual es el método utilizado por el IDEAM para espacializar sus registros de SPI calculados sobre las estaciones meteorológicas, tampoco es claro el error o incertidumbre asociada a dicha estimación.\cite{garcia2014estudio} \cite{ideam2018estudio}.\\

Por otro lado desde el punto de vista de la academia se han presentado una serie de propuestas de mejoras sobre la modelación de sequías, mejoras que dadas las limitaciones de datos y recursos de computo se intento implementar, por ejemplo la estimación estándar el *SPI* se realiza mediante la estandarización de una función de probabilidad que se ajuste a un racha de precipitación medida en una estación, meteorológica dada; sin embargo esta aproximación supone cierta homogeneidad en la zona de estudio, puesto que asume que el comportamiento de la precipitación sera similar en un área determinada.\\

Este no siempre es el caso, sobre todo cuando los estudios cubre áreas extensas, debido a lo anterior\cite{farahmand2015generalized}, introduce en al literatura el *SPI No Paramétrico*, que proponen dada la falta de flexibilidad del método actual, este consiste en ajustar una función de probabilidad empírica a las precipitaciones de cada estación meteorológica de la zona de estudio, y posteriormente realizar la estandarización para estimar el SPI.\\

En su estudio \cite{farahmand2015generalized} en comparación al presente estudio, trabajan su modelación de sequía a una resolución menos detallada, en una extensión global y con unas fuentes de datos que se limitan a datos de precipitación calculados por diferentes centros espcializados a nivel internacional, además por la amplitud de la zona de estudio usan el algoritmo k-vecinos (para identificar 5 regiones climáticas) como aproximación a la regionalización climática de su zona de estudio y proceden a calcular modelos individuales especializados para cada uno de  los cinco regiones. Finalmente y probablemente debido a la mayor amplitud de las fuentes de información obtengan resultados relevantes como un R² mínimo de 0.95, en comparación al R² de 0.777 en promedio para el Random Forest y el R² de 0.769 para el XGBoosts obtenidos en este estudio.\\

Más recientemente la literatura en cuanto a la modelación de sequías a virado a el uso de técnicas que permitan una espacialización fidedigna de los índices de sequía calculados usando datos de estaciones meteorológicas, es el caso de \cite{rhee2017meteorological}, \cite{PARK2016157}, \cite{park2017drought}. \\

Esta clase de aproximaciones a la sequía, al ser basados en modelos impulsados por datos, usualmente requieren de una gran cantidad de datos para ajustar los modelos, por lo que la baja densidad y en ocasiones los problemas de calidad de los datos en la zona estudiada pueden llegar a impactar la capacidad de los modelos para explicar el fenómeno de sequía estudiado.\\

Aunque los autores consultados realizaron estudios con un número de estaciones variable lo que puede impactar la comparación de los estudios, que aunque poseen condiciones similares, estas distan de ser idénticas. Por ejemplo \cite{feng2019machine} usa en su estudio dos redes de estaciones independientes, localizadas en el sur-oriente de Australia, uno correspondiente a 13 estaciones usadas para entrenar y validar el modelo, y otra red que asciende a 2242 estaciones, usadas unicamente con el propósito de testear los modelos, en un área que asciende a 360 000 km². Por su parte \cite{rhee2017meteorological} centra su estudio sobre la península coreana, incluyendo 61 estaciones sobre un área de estudio de unos 100 284 km². En comparación el presente estudio se utilizaron 51 estaciones sobre un área de unos 30 000 km² aproximadamente.\\

En cuanto a los datos de precipitación, su uso no varía mucho entre los diferentes autores, se usan los datos en mm como principal predictor de los modelos aplicados. Por ejemplo  \cite{alizadeh2018fusion} enfocó su estudio únicamente en precipitación, no uso predictores adicionales, para compensar esto combinó diferentes productos satelitales para tener distintas estimaciones de sequía para cada unidad mínima observada.\\

Sin embargo, debido a la gran cantidad de productos derivados del sensor MODIS, este provee de varios predictores, por ejemplo \cite{rhee2017meteorological}, utiliza variables como la temperatura superficial (LST), la Precipitación, Índices de vegetación (NDVI), además de algunas bandas espectrales 7 en total. Por su parte \cite{park2017drought} en su estudio enfocado en la sequía agrícola, y la humedad del suelo, utilizó con predictores la temperatura superficial (LST), la evapotranspiración (ET), el Albedo, índice de área foliar (LAI), e indices de vegetación (NDVI, EVI). Basado en lo anterior, en el presente estudio se seleccionaron las variables predictoras, Precipitación, Temperatura Superficial (LST), variables del ciclo hidrológico Evapotranspiración (ET) comportamiento de la vegetación, índice de área foliar (LAI), e índices de vegetación  (NDVI, ET), un indice de humedad (NDWI) y una aproximación a la sequía (NDDI).\\



# \cite{alizadeh2018fusion}\cite{rhee2017meteorological} \cite{feng2019machine}

Finalmente, \cite{PARK2016157} indica como las variables Temperatura Superficial (LST) y Evapotranspiración (ET) muestran una importancia alta para la estimación del SPI en el corto plazo, a diferencia de otros predictores como el los índices de vegetación (NDVI) y el Índice Normalizado de Sequía Multi-Banda (NDMI) que tienen implicaciones en el largo plazo. Esto contrasta con los resultados obtenidos en este estudio donde las ventanas temporales seleccionadas se conservo el orden de la importancia de las variables predictoras, encabezadas por la Precipitación,  Temperatura Superficial (LST) y el Índice de Sequía Normalizado (NDDI).\\

De manera similar los estudios consultados son consistentes con el presente en que los modelos derivados de los CART como el Bosque Aleatorio (RF) o el Aumento Extremo del Gradiente (XGBoost) obtienen mejores resultados en este tipo de problemas. Por ejemplo \cite{park2017drought} al igual que  \cite{PARK2016157} evalua el uso de modelos como Bosque Aleatorio (RF), Cubista, y /Bossted Regression Trees/; por su parte \cite{rhee2017meteorological} opta por el uso de CART y Arboles Extremadamente Aleatorios.\\

Por el contrario otros autores consideran otros modelos como las Máquinas  de Soporte Vectorial (SVM), y las Redes Neuronales en sus mas simples arquitecturas \cite{feng2019machine}. Otros optan por modelos menos comunes como lo son /Adaptative Neuro-Fuzzy Inference System/ (ANFIS), M5P /model tree/, /Group Method of Data Handling/ (GMDH) \cite{alizadeh2018fusion}.


# \cite{rhee2017meteorological}\cite{alizadeh2018fusion}\cite{park2017drought}

La mayor parte de los autores anteriormente mencionados son bastante consistentes, que dado que se trata de resolver un problema de regresión, las métricas utilizadas para entrenar y evaluar los modelos se centraron principalmente en Raíz del Error Medio Cuadrático (RMSE por sus siglas en ingles) y el Error Absoluto Medio (MAE por sus siglas en ingles).\\

Sumado al uso de R², como indicador adicional de que tan ajustada es la predicción de los valores por parte de los modelos. Obteniendo diversos resultados, por ejemplo \cite{park2017drought} obtuvo un R² 0.52 y un rmse DE 0.09. \\

Por su parte \cite{PARK2016157} obtuvo un R² de 0.93 y un RMSE de 0.3, lo que implica que a pesar de un buen ajuste en de los valores los errores son altos, lo que podría indicar un posible sesgo por parte del modelo. De igual modo \cite{feng2019machine} obtiene un R² de 0.28 y un RMSE de 0.9. En el  ente estudio se obtuvo \\ obtiene un R² de 0.28 y un RMSE de 0.9. En el presente estudio se obtuvo \\ obtiene un R² de 0.28 y un RMSE de 0.9. En el presente estudio se obtuvo en promedio un R² de para Bosque Aleatorio y n R² para Aumento Extremo del Gradiente (XGBoost) con un RMSE asociado de para RF y de XGBoosts. \\

Existe sin embargo una dificultad para la comparación directa entre estos modelos, y esta es precisamente la evaluación de los mismos, dadas las particularidades de los datos espacio-temporales, descritas en este documento, hacen que el evaluar un modelo que pretende capturar el comportamiento de un fenómeno espacio-temporal como la sequía es algo no trivial, existen dos posibles estrategias de evaluación, la primera es el uso de dos conjuntos independientes de datos que permita un testeo del modelo como en el caso de  \cite{feng2019machine}. Sin embargo, esto es difícil de realizar, sobre todo en países en vías de desarrollo; por lo que otro método popular para realizar la evaluación es la validación cruzada.\\


En el presente trabajo se implemento  una rutina para aplicar el método de Validación Cruzada LLTO propuesto por \cite{meyer_improving_2018} (y descrito en [[secvalcruz]]) usando esta metodología la idea es realizar evaluación mas realista de los modelos espacio-temporales, los autores de esta estrategia aplicaron este método para tratar de estimar la Temperatura Superficial (LST ) en el continente Antártico \cite{meyer2016mapping}.\\

Finalmente es de resaltar que la evaluación de los modelos espacio-temporales es un tópico aún en investigación, y en proceso de consolidación, por lo que el debate de aplicar o no estas estrategias aún esta abierto.\\


* Conclusiones
<<secconclu>>

En el presente trabajo se implemento una metodología para el moldeamiento de una función de interpolación no lineal, para la espacialización del indicador *SPI no paramétrico* en la zona de estudio del departamento de La Guajira, Colombia entre el año *2000* y el año *2014*. Como un estudio de caso en el modelamiento de sequías.\\

Para lo anterior, se sustentaron los pasos metodológicos en revisión de literatura, de diferentes disciplinas, que desde su perspectivas apoyaron a diferentes partes del presente trabajo.\\

El proceso metodológico comprendió la identificación, evaluación y selección de una serie de estaciones meteorológicas entre *1982* y el *2012* aptas para el cálculo del SPI no paramétrico mediante la agregación de la precipitación a acumulados mensuales y su relleno en aquellas ventanas temporales donde existían datos faltantes mediante un método de imputación de datos; ademas de la descarga,  proyección, recorte, aplicación de mascara y homogenización temporal con el acumulado o promedio de datos a nivel mensual.\\

Se seleccionaron variables explicativas y se optó por tres modelos de aprendizaje de maquina para realizar la interpolación, las redes neuronales, y clásico y robusto Random Forest, y la promesa XGBoosts.\\

De estos el  que mejor resultado obtuvo fue en XGBoosts con una correlación o R² de 0.777 y de un MSE de 0.914 y un MAE de 0.841 frente a Random Forest con un R² de 0.768 y un MSE de 0.914 y un MAE de 0.841.\\

Al ser datos con autocorrelacion espacial y temporal se optó por realizar el entrenamiento de los modelos usando la metodología de validación cruzada k-fold tipo LLTO (Leave Location and Time Out) con el fin de obtener una evaluación mas fidedigna.\\

Esta metodología presenta  fortalezas como la posibilidad de aplicarse sobre vastos territorios sin cambio significativos, su escaliabilidad para realizar un monitoreo a nivel nacional, funciona con una precisión alta a pesar de la poca disponibilidad de información. Pero tiene debilidades como la necesidad de investigar más sobre los modelos espacio temporales y como evaluarlos.\\

El presente trabajo como caso de uso, puede ser un insumo para la formulación de monitoreo de sequías por  parte de las autoridades del país, las metodologías expuestas aunque en una área limitada, demuestran que es posible escalarlas.

Algunos temas dejados por fuera de este trabajo tienen el potencial de mejorar los resultados aquí expuestos, por ejemplo la incorporación de experimentos en métodos mas sofisticados de selección de características de evaluación de los modelos con conjuntos de datos independientes, entre otros.



* Observaciones y Recomendaciones
<<secobs>>

Una observación importante sobre la metodología presentada y es que el sensor /MODIS/ (/Moderate-Resolution Imaging Spectroradiometer/) abordo de los vehículos satelitales /Terra/ y /Aqua/, y del que se derivan la mayoría de las variables predictoras de este proyecto se encuentra muy cerca del final de su vida util, y su reemplazo el sensor VIIRS (/Visible Infrared Imaging Radiometer Suite/) abordo del vehículo satelital /Suomi NPP (National Polar-Orbiting Partnership)/, aún no tiene en fase operacional los mismos productos científicos que el actual /MODIS/, por lo que la continuidad de las observaciones no esta garantizado.\\

* Anexos
<<secanex>>
** AED Estaciones Metereológicas

A continuación hay unas muestras del comportamiento del SPI entre el 2000 y el 2014, aunque se ven claras diferencias entre las distintas estaciones podemos notar un inicio de década más bien húmedo, y con un periodo de sequía a inicios de la década de 2010, en algunas estaciones sin embargo es posible detallar el fenómeno de la niña del año 2011.\\

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1632_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1741_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1737_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1730_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1726_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1726_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1632_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1726_.png]]

#+CAPTION: Perfil temporal entre los valores reales y predichos XGBoosts 3 Meses
#+ATTR_LATEX: :width 10cm
#+LABEL: fig:perfil_temporal_XG_trn_completa
[[~/Dropbox/0_Tesis/imagenes/SPI_1724_.png]]



** Imputación de datos
# [fn:13]
<<secidf>>

El problema del relleno de datos faltantes es común en las ciencias ambientales, muchas veces se generan información que por diversas razones esta contaminada y puede ser explotada solo parcialmente o no ser explotada en absoluto.\\

Por tal motivo desde distintas disciplinas sean desarrollado métodos para resolver este problema dependiendo del tipo de dato que se pierde y adaptando a dominios precisos.\\

Dado que los productos satelitales ópticos e infrarrojos son altamente afectados por la presencia de nubes, en este trabajo nos servimos de un algoritmo llamado *DINEOF* desarrollado para el relleno de datos en series remotamente sensadas de datos oceanográficos para el relleno de los datos, de las variables predictoras afectadas por la nubosidad (LST, NDVI, EVI, LAI, ET).\\

Dicho método se basa en las *EOF* o /Empirical Orthogonal Functions/ por como son conocidos estos métodos en la comunidad oceanografica, también conocida en otras comunidades como un tipo especial de los /Componentes Principales/ .\\






** Ciencia Reproducible
<<seccr>>

En el animo de seguir los postulados de la /Ciencia Reproducible/, que aboga por compartir libremente no solo los resultados de una investigación sino de los elementos necesarios para reproducirla, esto incluye una descripción clara del procedimiento seguido, los datos en orden de ejecutar los experimentos sumado a el código fuente y el ambiente de desarrollo usado, son compartidos, con el fin de detectar posibles errores. \\

En este orden de ideas es posible consultar esta información a través de internet los elementos anteriormente descritos, en las siguientes plataformas.\\

- Ambiente de desarrollo:
 *[[https://hub.docker.com/repository/docker/jsvinasco/grass-py3-ml2][DockerHub]]*

- Código desarrollado:
 *[[https://github.com/JSVinasco/spatioTemporalDrought][Repositorio en GitHub]]*

- La base de datos generada para este proyecto:
  *[[https://drive.google.com/drive/folders/1P6Wa3zRBHy4u5txvLanaA6nBIgrA3vAB?usp=sharing][Sequía]]*



* Bibliografía
<<secbiblio>>
  :PROPERTIES:
  :TITLE: f
  :UNNUMBERED: t
  :END:
  #+LATEX: \printbibliography[heading=none]

* Footnotes
[fn:14]  Para más información sobre XGBoosts consulte : \cite{chen2016xgboost}

[fn:13] Otras estrategias de /machine learning/ son aprendizaje no supervisado, aprendizaje semi-supervisado y aprendizaje de refuerzo.
# [fn:13] Este capitulo esta altamente inspirado en

[fn:12] Ver sección [[seccr]]
[fn:11] https://www.chc.ucsb.edu/data/chirps

[fn:10] Figuras tomadas de: \cite{Meyer}
[fn:9] /CV: Cross Validation/

[fn:8] https://www.usgs.gov/faqs/what-remote-sensing-and-what-it-used?qt-news_science_products=0#qt-news_science_products

[fn:7] https://oceanservice.noaa.gov/facts/remotesensing.html
[fn:6] https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/remote-sensing

[fn:5] En este trabajo utilizaremos los términos *Sensores Remotos*, *Teledetección* u *Observación de la Tierra* de manera indistinta y siempre refiriéndonos a el estudio de variables bio-físicas por medio de sensores sobre plataformas satelitales.
[fn:4] Las sequías agrícolas y socio-económicas queda por fuera del alcance de este trabajo, aunque algunas de las variables que describen el estrés hídrico son usadas como predictores.

[fn:1]https://deepmind.com/learning-resources/deep-learning-lecture-series-2020

[fn:2]http://introtodeeplearning.com/

[fn:3]http://introtodeeplearning.com/
